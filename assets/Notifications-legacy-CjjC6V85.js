!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?t(Object(o),!0).forEach(function(t){n(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function n(t,r,n){return(r=function(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function s(r,n,o,a){var s=n&&n.prototype instanceof l?n:l,u=Object.create(s.prototype);return i(u,"_invoke",function(r,n,o){var i,a,s,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return i=t,a=0,s=e,f.n=r,c}};function p(r,n){for(a=r,s=n,t=0;!d&&l&&!o&&t<u.length;t++){var o,i=u[t],p=f.p,h=i[2];r>3?(o=h===n)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=r<2&&p<i[1])?(a=0,f.v=n,f.n=i[1]):p<h&&(o=r<3||i[0]>n||n>h)&&(i[4]=r,i[5]=n,f.n=h,a=0))}if(o||r>1)return c;throw d=!0,n}return function(o,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),a=u,s=h;(t=a<2?e:s)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,s)):f.n=s:f.v=s);try{if(l=2,i){if(a||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=e}else if((t=(d=f.n<0)?s:r.call(n,f))!==c)break}catch(t){i=e,a=1,s=t}finally{l=1}}return{value:t,done:d}}}(r,o,a),!0),u}var c={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][n]?t(t([][n]())):(i(t={},n,function(){return this}),t),p=d.prototype=l.prototype=Object.create(f);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,i(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,i(p,"constructor",d),i(d,"constructor",u),u.displayName="GeneratorFunction",i(d,a,"GeneratorFunction"),i(p),i(p,a,"Generator"),i(p,n,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(o=function(){return{w:s,m:h}})()}function i(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}i=function(e,t,r,n){function a(t,r){i(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},i(e,t,r,n)}function a(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function s(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function s(e){a(i,n,o,s,c,"next",e)}function c(e){a(i,n,o,s,c,"throw",e)}s(void 0)})}}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}System.register(["./query-legacy-CLxXWLnl.js","./sentry-legacy-CTr2CudU.js","./index-legacy-DVoFAd51.js","./router-legacy-9xrJEksD.js","./store-legacy-Bt3CCSnU.js"],function(e,t){"use strict";var n,i,a,l,u,d,f,p,h;return{setters:[function(e){n=e.j},function(e){i=e.a},function(e){a=e.u,l=e.k,u=e.t,d=e.j,f=e.q},function(e){p=e.a,h=e.L},null],execute:function(){function t(e){if(!e)return null;try{return JSON.parse(e)}catch(t){return null}}e("default",function(){var e=p(),m=a().isAuthenticated,x=l().t,y=c(i.useState([]),2),v=y[0],b=y[1],g=c(i.useState(!0),2),j=g[0],w=g[1],k=c(i.useState(0),2),N=k[0],O=k[1],S=c(i.useState(1),2),C=S[0],P=S[1],L=c(i.useState(!1),2),_=L[0],A=L[1];i.useEffect(function(){m?M():e("/login")},[m,C,_]);var M=function(){var e=s(o().m(function e(){var t;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,w(!0),e.n=1,u.getNotifications({page:C,limit:20,unreadOnly:_});case 1:t=e.v,b(t.data.notifications||[]),O(t.data.total||0),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.p=3,w(!1),e.f(3);case 4:return e.a(2)}},e,null,[[0,2,3,4]])}));return function(){return e.apply(this,arguments)}}(),R=function(){var e=s(o().m(function e(t){return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,u.markRead(t);case 1:b(function(e){return e.map(function(e){return e.id===t?r(r({},e),{},{isRead:!0}):e})}),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=s(o().m(function e(){return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,u.markAllRead();case 1:b(function(e){return e.map(function(e){return r(r({},e),{},{isRead:!0})})}),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),E=function(e,r){var o=t(r);if("nearby_new_user"===e||"nearby_new_user"===(null==o?void 0:o.type))return null!=o&&o.avatar?n.jsx("div",{className:"w-11 h-11 rounded-full overflow-hidden ring-2 ring-pink-500/30 flex-shrink-0",children:n.jsx("img",{src:f(o.avatar),alt:"",className:"w-full h-full object-cover",onError:d})}):n.jsx("div",{className:"w-11 h-11 rounded-full bg-gradient-to-br from-pink-500/20 to-orange-500/20 flex items-center justify-center flex-shrink-0 ring-2 ring-pink-500/20",children:n.jsx("span",{className:"text-xl",children:"ðŸŽ­"})});switch(e){case"system":return n.jsx("div",{className:"w-11 h-11 rounded-full bg-blue-500/20 flex items-center justify-center flex-shrink-0",children:n.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})});case"warning":return n.jsx("div",{className:"w-11 h-11 rounded-full bg-yellow-500/20 flex items-center justify-center flex-shrink-0",children:n.jsx("svg",{className:"w-5 h-5 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})});case"success":return n.jsx("div",{className:"w-11 h-11 rounded-full bg-green-500/20 flex items-center justify-center flex-shrink-0",children:n.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})});default:return n.jsx("div",{className:"w-11 h-11 rounded-full bg-purple-500/20 flex items-center justify-center flex-shrink-0",children:n.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})})}},D=v.filter(function(e){return!e.isRead}).length;return n.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-bg)"},children:[n.jsx("header",{className:"sticky top-0 z-50 backdrop-blur-xl border-b",style:{background:"var(--color-bg-secondary)",borderColor:"var(--color-border)"},children:n.jsxs("div",{className:"max-w-3xl mx-auto px-4 h-14 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(h,{to:"https://kighub.cn/",className:"hover:opacity-80 transition",style:{color:"var(--color-text-muted)"},children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h1",{className:"text-lg font-medium",style:{color:"var(--color-text)"},children:x("notifications.title")}),D>0&&n.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-red-500/20 text-red-400 rounded-full",children:x("notifications.unreadCount").replace("{n}",String(D))})]})]}),D>0&&n.jsx("button",{onClick:T,className:"text-sm text-purple-400 hover:text-purple-300 transition px-3 py-1.5 rounded-lg hover:bg-purple-500/10",children:x("notifications.markAllRead")})]})}),n.jsx("div",{className:"max-w-3xl mx-auto px-4 py-3 border-b",style:{borderColor:"var(--color-border)"},children:n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:function(){A(!1),P(1)},className:"px-4 py-1.5 rounded-full text-sm transition ".concat(_?"text-white/60 hover:bg-white/10":"bg-purple-500/20 text-purple-400 ring-1 ring-purple-500/30"),style:_?{color:"var(--color-text-muted)"}:{},children:x("notifications.all")}),n.jsx("button",{onClick:function(){A(!0),P(1)},className:"px-4 py-1.5 rounded-full text-sm transition ".concat(_?"bg-purple-500/20 text-purple-400 ring-1 ring-purple-500/30":"text-white/60 hover:bg-white/10"),style:_?{}:{color:"var(--color-text-muted)"},children:x("notifications.unread")})]})}),n.jsxs("div",{className:"max-w-3xl mx-auto",children:[j?n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx("div",{className:"w-8 h-8 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"})}):0===v.length?n.jsxs("div",{className:"flex flex-col items-center justify-center py-20",style:{color:"var(--color-text-muted)"},children:[n.jsx("div",{className:"w-20 h-20 rounded-full bg-purple-500/10 flex items-center justify-center mb-4",children:n.jsx("svg",{className:"w-10 h-10 text-purple-400/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),n.jsx("p",{className:"text-base mb-1",children:x("notifications.empty")}),n.jsx("p",{className:"text-sm opacity-60",children:x("notifications.emptyHint")})]}):n.jsx("div",{className:"divide-y",style:{borderColor:"var(--color-border)"},children:v.map(function(r){var o,i,a,s,c,l,u=t(r.metadata),d=("nearby_new_user"===r.type||"nearby_new_user"===(null==u?void 0:u.type))&&(null==u?void 0:u.shareCode);return n.jsx("div",{className:"p-4 transition cursor-pointer ".concat(r.isRead?"":"bg-purple-500/5"," ").concat(d?"hover:bg-purple-500/10":"hover:bg-white/5"),onClick:function(){return function(r){r.isRead||R(r.id);var n=t(r.metadata);"nearby_new_user"===(null==n?void 0:n.type)&&n.shareCode&&e("/u/".concat(n.shareCode))}(r)},children:n.jsxs("div",{className:"flex gap-3",children:[E(r.type,r.metadata),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsx("h3",{className:"font-medium text-sm ".concat(r.isRead?"opacity-80":""),style:{color:"var(--color-text)"},children:r.title}),n.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:!r.isRead&&n.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-purple-500 shadow-lg shadow-purple-500/30"})})]}),n.jsx("p",{className:"text-sm mt-1 whitespace-pre-wrap",style:{color:"var(--color-text-muted)"},children:r.content}),n.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[n.jsx("p",{className:"text-xs",style:{color:"var(--color-text-muted)",opacity:.6},children:(o=r.createdAt,i=new Date(o),a=(new Date).getTime()-i.getTime(),s=Math.floor(a/6e4),c=Math.floor(a/36e5),l=Math.floor(a/864e5),s<1?x("notifications.justNow"):s<60?x("notifications.minutesAgo").replace("{n}",String(s)):c<24?x("notifications.hoursAgo").replace("{n}",String(c)):l<7?x("notifications.daysAgo").replace("{n}",String(l)):i.toLocaleDateString("zh-CN"))}),d&&n.jsx("span",{className:"text-xs text-purple-400 flex items-center gap-1",children:x("notifications.goSee")})]})]})]})},r.id)})}),N>20&&n.jsxs("div",{className:"flex items-center justify-center gap-2 py-6",children:[n.jsx("button",{onClick:function(){return P(function(e){return Math.max(1,e-1)})},disabled:1===C,className:"px-4 py-2 bg-white/5 hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-sm transition",children:x("notifications.prevPage")}),n.jsxs("span",{className:"text-sm",style:{color:"var(--color-text-muted)"},children:[C," / ",Math.ceil(N/20)]}),n.jsx("button",{onClick:function(){return P(function(e){return e+1})},disabled:C>=Math.ceil(N/20),className:"px-4 py-2 bg-white/5 hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-sm transition",children:x("notifications.nextPage")})]})]})]})})}}})}();
