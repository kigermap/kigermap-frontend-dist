!function(){function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var r,n,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function s(e,o,i,a){var s=o&&o.prototype instanceof u?o:u,l=Object.create(s.prototype);return t(l,"_invoke",function(e,t,o){var i,a,s,u=0,l=o||[],d=!1,f={p:0,n:0,v:r,a:p,f:p.bind(r,4),d:function(e,t){return i=e,a=0,s=r,f.n=t,c}};function p(e,t){for(a=e,s=t,n=0;!d&&u&&!o&&n<l.length;n++){var o,i=l[n],p=f.p,m=i[2];e>3?(o=m===t)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=r):i[0]<=p&&((o=e<2&&p<i[1])?(a=0,f.v=t,f.n=i[1]):p<m&&(o=e<3||i[0]>t||t>m)&&(i[4]=e,i[5]=t,f.n=m,a=0))}if(o||e>1)return c;throw d=!0,t}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,m),a=l,s=m;(n=a<2?r:s)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,s)):f.n=s:f.v=s);try{if(u=2,i){if(a||(o="next"),n=i[o]){if(!(n=n.call(i,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,a<2&&(a=0)}else 1===a&&(n=i.return)&&n.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=r}else if((n=(d=f.n<0)?s:e.call(t,f))!==c)break}catch(n){i=r,a=1,s=n}finally{u=1}}return{value:n,done:d}}}(e,i,a),!0),l}var c={};function u(){}function l(){}function d(){}n=Object.getPrototypeOf;var f=[][i]?n(n([][i]())):(t(n={},i,function(){return this}),n),p=d.prototype=u.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=d,t(p,"constructor",d),t(d,"constructor",l),l.displayName="GeneratorFunction",t(d,a,"GeneratorFunction"),t(p),t(p,a,"Generator"),t(p,i,function(){return this}),t(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:s,m:m}})()}function t(e,r,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,r,n,o){function a(r,n){t(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[r]=n:(a("next",0),a("throw",1),a("return",2))},t(e,r,n,o)}function r(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function n(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){var a=e.apply(t,n);function s(e){r(a,o,i,s,c,"next",e)}function c(e){r(a,o,i,s,c,"throw",e)}s(void 0)})}}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}System.register(["./index-legacy-DVoFAd51.js","./query-legacy-CLxXWLnl.js","./sentry-legacy-CTr2CudU.js"],function(t,r){"use strict";var i,a,s;return{setters:[function(e){i=e._},function(e){a=e.j},function(e){s=e.a}],execute:function(){t("L",function(t){var c=t.value,p=t.onChange,m=t.placeholder,h=void 0===m?"点击地图选择位置":m,x=s.useRef(null),v=s.useRef(null),y=s.useRef(null),b=s.useRef(null),g=s.useRef(null),w=o(s.useState(!1),2),j=w[0],k=w[1],A=o(s.useState(""),2),E=A[0],N=A[1],C=o(s.useState(!1),2),_=C[0],S=C[1],P=o(s.useState(!1),2),L=P[0],T=P[1],I=o(s.useState(!1),2),M=I[0],O=I[1],G=o(s.useState(""),2),R=G[0],V=G[1],z=o(s.useState(c),2),F=z[0],q=z[1];s.useEffect(function(){q(c)},[c]);var B=s.useCallback(function(e,t){v.current&&y.current&&(v.current.setZoomAndCenter(14,[e,t]),b.current?b.current.setPosition([e,t]):b.current=new y.current.Marker({position:[e,t],map:v.current}))},[]),Y=s.useCallback(function(e,t){return new Promise(function(r){var n=f(e,t);"中国"===n?g.current?g.current.getAddress([e,t],function(n,o){if("complete"===n&&o.regeocode){var i=o.regeocode.addressComponent;r({lat:t,lng:e,country:i.country||"中国",province:i.province||"",city:i.city||i.district||"",address:o.regeocode.formattedAddress||""})}else r({lat:t,lng:e,country:"中国"})}):r({lat:t,lng:e,country:n}):r({lat:t,lng:e,country:n,province:"",city:"",address:""})})},[]),D=s.useCallback(function(){var t=n(e().m(function t(r,n){var o;return e().w(function(e){for(;;)switch(e.n){case 0:return B(r,n),e.n=1,Y(r,n);case 1:o=e.v,q(o),p(o);case 2:return e.a(2)}},t)}));return function(e,r){return t.apply(this,arguments)}}(),[B,Y,p]);s.useEffect(function(){if(j&&x.current&&!v.current){window._AMapSecurityConfig={securityJsCode:u("VITE_AMAP_SECRET")};var t=function(){var t=n(e().m(function t(){var o,a,s;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,i(n(e().m(function t(){var n,o;return e().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r.import("./index-legacy-CVgrV_LA.js").then(function(e){return e.i});case 1:return n=e.v,o=n.default,e.a(2,{default:o})}},t)})),void 0);case 1:return o=t.v.default,t.n=2,o.load({key:u("VITE_AMAP_KEY"),version:"2.0",plugins:["AMap.Geocoder","AMap.PlaceSearch","AMap.Geolocation"]});case 2:a=t.v,y.current=a,s=new a.Map(x.current,{zoom:F?12:4,center:F?[F.lng,F.lat]:[105,35],mapStyle:"amap://styles/3cb53faf98f9ff2733c29ffa1089a230"}),v.current=s,g.current=new a.Geocoder,F&&(b.current=new a.Marker({position:[F.lng,F.lat],map:s})),s.on("click",function(e){var t=e.lnglat,r=t.lng,n=t.lat;D(r,n)}),T(!0),t.n=4;break;case 3:t.p=3,t.v;case 4:return t.a(2)}},t,null,[[0,3]])}));return function(){return t.apply(this,arguments)}}();return t(),function(){var e;null===(e=v.current)||void 0===e||e.destroy(),v.current=null,y.current=null,b.current=null,T(!1)}}},[j]),s.useEffect(function(){L&&F&&v.current&&B(F.lng,F.lat)},[L,F,B]);var U=function(){return new Promise(function(e,t){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(e,t,{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})}else t(new Error("您的浏览器不支持定位功能"))})},H=function(){return new Promise(function(e,t){y.current?new y.current.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonPosition:"RB",zoomToAccuracy:!0,GeoLocationFirst:!0}).getCurrentPosition(function(r,n){"complete"===r?e({lng:n.position.lng,lat:n.position.lat}):t(new Error(n.message||"定位失败"))}):t(new Error("地图未初始化"))})},Q=function(){var t=n(e().m(function t(){var r,n,o,i,a,s;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return O(!0),V(""),e.p=1,e.p=2,e.n=3,U();case 3:o=e.v,r=o.coords.longitude,n=o.coords.latitude,e.n=10;break;case 4:if(e.p=4,a=e.v,!L||!y.current){e.n=9;break}return e.p=5,e.n=6,H();case 6:i=e.v,r=i.lng,n=i.lat,e.n=8;break;case 7:throw e.p=7,e.v,new Error(W(a));case 8:e.n=10;break;case 9:throw new Error(W(a));case 10:return e.n=11,D(r,n);case 11:e.n=13;break;case 12:e.p=12,s=e.v,V(s.message||"定位失败，请手动选择位置");case 13:return e.p=13,O(!1),e.f(13);case 14:return e.a(2)}},t,null,[[5,7],[2,4],[1,12,13,14]])}));return function(){return t.apply(this,arguments)}}(),W=function(e){if(e.code)switch(e.code){case 1:return l()?"请在QQ浏览器设置中允许位置权限，或手动选择位置":d()?"请在微信设置中允许位置权限，或手动选择位置":"定位权限被拒绝，请在浏览器设置中允许位置权限";case 2:return"无法获取位置信息，请检查网络或GPS设置";case 3:return"定位超时，请检查网络连接后重试";default:return"定位失败，请手动选择位置"}return e.message||"定位失败，请手动选择位置"},K=function(){var t=n(e().m(function t(){return e().w(function(e){for(;;)switch(e.n){case 0:if(E.trim()&&v.current&&y.current){e.n=1;break}return e.a(2);case 1:S(!0);try{new y.current.PlaceSearch({city:"全国",pageSize:1}).search(E,function(e,t){var r;if("complete"===e&&(null===(r=t.poiList)||void 0===r||null===(r=r.pois)||void 0===r?void 0:r.length)>0){var n=t.poiList.pois[0].location,o=n.lng,i=n.lat;D(o,i)}S(!1)})}catch(t){S(!1)}case 2:return e.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),J=F?[F.country,F.province,F.city].filter(Boolean).join(" · "):h;return a.jsxs("div",{className:"relative",children:[a.jsx("button",{type:"button",onClick:function(){return k(!0)},className:"w-full px-4 py-3 text-left glass rounded-xl hover:bg-white/10 transition",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),a.jsx("span",{className:F?"text-white":"text-white/50",children:J})]})}),j&&a.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-end sm:items-center justify-center z-50 sm:p-4",children:a.jsxs("div",{className:"glass-dark rounded-t-2xl sm:rounded-2xl w-full sm:max-w-2xl max-h-[85vh] sm:max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b border-white/10 flex-shrink-0",children:[a.jsx("h3",{className:"font-semibold text-white text-sm sm:text-base",children:"选择位置"}),a.jsx("button",{onClick:function(){return k(!1)},className:"p-1.5 sm:p-2 hover:bg-white/10 rounded-full transition",children:a.jsx("svg",{className:"w-5 h-5 text-white/70",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto overscroll-contain",children:[a.jsxs("div",{className:"p-3 sm:p-4 border-b border-white/10",children:[a.jsx("button",{onClick:Q,disabled:M,className:"w-full flex items-center justify-center gap-2 px-3 sm:px-4 py-2.5 sm:py-3 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-400 hover:to-blue-400 disabled:opacity-50 rounded-xl text-white text-sm sm:text-base font-medium transition-all",children:M?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 sm:w-5 sm:h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),a.jsx("span",{children:"正在定位..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})}),a.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})}),a.jsx("span",{children:"快速定位当前位置"})]})}),R&&a.jsx("p",{className:"mt-2 text-xs sm:text-sm text-red-400 text-center",children:R}),a.jsx("p",{className:"mt-1.5 sm:mt-2 text-[10px] sm:text-xs text-white/40 text-center",children:l()?"使用QQ浏览器定位，请确保已授权位置权限":"点击按钮自动获取当前位置"})]}),a.jsx("div",{className:"p-3 sm:p-4 border-b border-white/10",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:E,onChange:function(e){return N(e.target.value)},onKeyDown:function(e){return"Enter"===e.key&&K()},placeholder:"或搜索地点名称...",className:"flex-1 px-3 sm:px-4 py-2 bg-white/5 border border-white/10 rounded-xl text-white text-sm placeholder-white/40 outline-none focus:border-primary/50"}),a.jsx("button",{onClick:K,disabled:_||!L,className:"px-3 sm:px-4 py-2 btn-gradient rounded-xl text-white text-sm disabled:opacity-50",children:_?"...":"搜索"})]})}),a.jsx("div",{ref:x,className:"h-48 sm:h-80"}),F&&a.jsxs("div",{className:"p-3 sm:p-4 border-t border-white/10 bg-white/5",children:[a.jsxs("p",{className:"text-xs sm:text-sm text-white/80",children:["已选择: ",[F.country,F.province,F.city].filter(Boolean).join(" · ")]}),a.jsxs("p",{className:"text-[10px] sm:text-xs text-white/40 mt-1",children:["坐标: ",F.lat.toFixed(6),", ",F.lng.toFixed(6)]})]})]}),a.jsxs("div",{className:"p-3 sm:p-4 border-t border-white/10 flex justify-end gap-2 sm:gap-3 flex-shrink-0 bg-[#0a0a0f]/95",children:[a.jsx("button",{onClick:function(){return k(!1)},className:"px-4 py-2 glass rounded-xl text-white/70 hover:text-white hover:bg-white/10 transition text-sm",children:"取消"}),a.jsx("button",{onClick:function(){return k(!1)},disabled:!F,className:"px-4 py-2 btn-gradient rounded-xl text-white disabled:opacity-50 text-sm",children:"确认"})]})]})})]})});var c={BASE_URL:"https://cdn-frontend-static.kigermap.com/",DEV:!1,LEGACY:!0,MODE:"production",PROD:!0,SSR:!1,VITE_ALIYUN_CAPTCHA_IDENTITY:"esa-sti6ljl6z5",VITE_ALIYUN_CAPTCHA_PREFIX:"ut6aks",VITE_ALIYUN_CAPTCHA_REGION:"cn",VITE_ALIYUN_CAPTCHA_SCENE_ID:"1wu7t9tq",VITE_AMAP_KEY:"05a185cb1d11ced37ca7d8f96d1a3aec",VITE_AMAP_SECRET:"65bd040d9943b44c16d1870e23fd9de9",VITE_API_URL:"https://api.kigermap.com/v1",VITE_QQ_APP_ID:"102821653"},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{if(void 0!==r.meta&&c)return c[e]||t}catch(n){}return t},l=function(){var e=navigator.userAgent.toLowerCase();return e.includes("qq")||e.includes("mqqbrowser")||e.includes("qqbrowser")},d=function(){return navigator.userAgent.toLowerCase().includes("micromessenger")},f=function(e,t){return e>=73&&e<=135&&t>=18&&t<=54?"中国":e>=129&&e<=146&&t>=30&&t<=46?"日本":e>=124&&e<=132&&t>=33&&t<=39?"韩国":e>=119&&e<=122&&t>=21&&t<=26?"中国台湾":e>=113.8&&e<=114.5&&t>=22.1&&t<=22.6?"中国香港":e>=113.5&&e<=113.6&&t>=22.1&&t<=22.2?"中国澳门":e>=95&&e<=141&&t>=-11&&t<=28?e>=100&&e<=105&&t>=5&&t<=21?"泰国":e>=103&&e<=104&&t>=1&&t<=2?"新加坡":e>=99&&e<=119&&t>=-8&&t<=6?"印度尼西亚":e>=116&&e<=127&&t>=5&&t<=21?"菲律宾":e>=100&&e<=109&&t>=1&&t<=7?"马来西亚":e>=102&&e<=108&&t>=8&&t<=24?"越南":"东南亚":e>=-125&&e<=-66&&t>=24&&t<=50?"美国":e>=-141&&e<=-52&&t>=41&&t<=84?"加拿大":e>=-10&&e<=40&&t>=35&&t<=72?"欧洲":e>=113&&e<=154&&t>=-44&&t<=-10?"澳大利亚":"海外"}}}})}();
