import{j as e}from"./query-DSsWWIdM.js";import{a as t}from"./sentry-DvvTOdwe.js";import{u as s,f as a,b as i,j as r,D as o,c as n}from"./index-D0yqgRjz.js";import{L as l}from"./router-jbVFofSC.js";import"./store-BXxpTH1V.js";function c(){const{isAuthenticated:r}=s(),[o,n]=t.useState("users"),[c,m]=t.useState([]),[p,u]=t.useState([]),[j,v]=t.useState(!0),[g,f]=t.useState(!1),[,w]=t.useState(null);t.useEffect(()=>{r?b():v(!1)},[r]),t.useEffect(()=>{r&&"photos"===o&&0===p.length&&N()},[r,o]);const b=async()=>{v(!0),w(null);try{const e=await a.getFavorites();m(e.data.favorites||[])}catch(e){w("获取收藏列表失败")}finally{v(!1)}},N=async()=>{f(!0);try{const e=await i.get("/plaza/favorites");u(e.data.photos||[])}catch(e){}finally{f(!1)}};return r?e.jsxs("div",{className:"min-h-screen bg-[#0a0a0f]",children:[e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-purple-900/10 via-transparent to-cyan-900/10 pointer-events-none"}),e.jsx(d,{}),e.jsxs("main",{className:"max-w-4xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex gap-2 mb-6 p-1 bg-white/5 rounded-xl w-fit",children:[e.jsx("button",{onClick:()=>n("users"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all ".concat("users"===o?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":"text-white/60 hover:text-white"),children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"收藏玩家",c.length>0&&e.jsxs("span",{className:"text-xs opacity-70",children:["(",c.length,")"]})]})}),e.jsx("button",{onClick:()=>n("photos"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all ".concat("photos"===o?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":"text-white/60 hover:text-white"),children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"收藏娃图",p.length>0&&e.jsxs("span",{className:"text-xs opacity-70",children:["(",p.length,")"]})]})})]}),"users"===o?e.jsx(h,{loading:j,favorites:c,onRemove:async(e,t)=>{try{await a.removeFavorite(e),m(e=>e.filter((e,s)=>s!==t))}catch(s){b()}}}):e.jsx(x,{loading:g,photos:p,onRemove:async e=>{try{await i.post("/plaza/photos/unfavorite",{photoId:e}),u(t=>t.filter(t=>t.id!==e))}catch(t){}}})]})]}):e.jsxs("div",{className:"min-h-screen bg-[#0a0a0f]",children:[e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-purple-900/10 via-transparent to-cyan-900/10 pointer-events-none"}),e.jsx(d,{}),e.jsx("main",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-white/5 rounded-2xl flex items-center justify-center",children:e.jsx("svg",{className:"w-10 h-10 text-white/30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"请先登录"}),e.jsx("p",{className:"text-white/50 mb-6",children:"登录后即可查看您的收藏列表"}),e.jsx(l,{to:"/login",className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl text-white font-medium hover:opacity-90 transition",children:"登录"})]})})]})}function d(){return e.jsx("header",{className:"sticky top-0 z-50 backdrop-blur-xl bg-[#0a0a0f]/80 border-b border-white/[0.06]",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 h-16 flex items-center gap-4",children:[e.jsxs(l,{to:"https://kighub.cn/",className:"flex items-center gap-2 text-white/60 hover:text-white transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{className:"hidden sm:inline text-sm",children:"返回"})]}),e.jsx("div",{className:"h-6 w-px bg-white/10 hidden sm:block"}),e.jsx("h1",{className:"text-lg font-semibold",children:"我的收藏"})]})})}function h({loading:t,favorites:s,onRemove:a}){return t?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:[1,2,3,4,5,6].map(t=>e.jsxs("div",{className:"bg-white/5 rounded-xl overflow-hidden animate-pulse",children:[e.jsx("div",{className:"aspect-square bg-white/10"}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-white/10 rounded w-1/2"})]})]},t))}):0===s.length?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-white/5 rounded-2xl flex items-center justify-center",children:e.jsx("svg",{className:"w-10 h-10 text-white/30",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"暂无收藏玩家"}),e.jsx("p",{className:"text-white/50 mb-6",children:"浏览娃娃主页时，点击收藏按钮即可添加"}),e.jsx(l,{to:"https://kighub.cn/",className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl text-white font-medium hover:opacity-90 transition",children:"浏览娃娃"})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:s.map((t,s)=>{var i,l,c,d;return e.jsxs("div",{className:"group relative bg-white/5 rounded-xl overflow-hidden hover:bg-white/10 transition-colors cursor-pointer",onClick:()=>window.location.href="/u/".concat(t.shareCode),children:[e.jsxs("div",{className:"aspect-square relative",children:[e.jsx("img",{src:n(t.avatar||(null==(i=t.photos)?void 0:i[0]))||o,alt:t.cnName,className:"w-full h-full object-cover",onError:r}),e.jsx("button",{onClick:e=>{e.stopPropagation(),a(t.shareCode,s)},className:"absolute top-2 right-2 w-8 h-8 rounded-full bg-pink-500/30 backdrop-blur-md flex items-center justify-center opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{className:"w-4 h-4 text-pink-400",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-medium text-white truncate",children:t.cnName}),e.jsx("p",{className:"text-xs text-white/50 mt-1",children:(null==(l=t.location)?void 0:l.city)||(null==(c=t.location)?void 0:c.province)||(null==(d=t.location)?void 0:d.country)||"未知"})]})]},t.shareCode)})})}function x({loading:s,photos:a,onRemove:i}){const[l,c]=t.useState(null);return s?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:[1,2,3,4,5,6].map(t=>e.jsx("div",{className:"bg-white/5 rounded-xl overflow-hidden animate-pulse",children:e.jsx("div",{className:"aspect-square bg-white/10"})},t))}):0===a.length?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-white/5 rounded-2xl flex items-center justify-center",children:e.jsx("svg",{className:"w-10 h-10 text-white/30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"暂无收藏娃图"}),e.jsx("p",{className:"text-white/50 mb-6",children:"在广场浏览娃图时，点击收藏按钮即可添加"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:a.map(t=>e.jsx("div",{className:"group relative bg-white/5 rounded-xl overflow-hidden hover:bg-white/10 transition-colors cursor-pointer",onClick:()=>c(t),children:e.jsxs("div",{className:"aspect-square relative",children:[e.jsx("img",{src:n(t.thumbnailUrl||t.url),alt:"收藏的娃图",className:"w-full h-full object-cover",onError:r}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:n(t.ownerAvatar)||o,alt:t.ownerName,className:"w-6 h-6 rounded-full object-cover",onError:r}),e.jsx("span",{className:"text-white text-sm truncate",children:t.ownerName})]})})}),e.jsx("button",{onClick:e=>{e.stopPropagation(),i(t.id)},className:"absolute top-2 right-2 w-8 h-8 rounded-full bg-pink-500/30 backdrop-blur-md flex items-center justify-center opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{className:"w-4 h-4 text-pink-400",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})}),t.likeCount>0&&e.jsxs("div",{className:"absolute bottom-2 left-2 flex items-center gap-1 px-2 py-1 bg-black/40 backdrop-blur-sm rounded-full text-xs text-white",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),t.likeCount]})]})},t.id))}),l&&e.jsx(m,{photo:l,onClose:()=>c(null),onRemove:()=>{i(l.id),c(null)}})]})}function m({photo:t,onClose:s,onRemove:a}){return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:s,children:e.jsxs("div",{className:"relative max-w-3xl max-h-[90vh] mx-4",onClick:e=>e.stopPropagation(),children:[e.jsx("button",{onClick:s,className:"absolute -top-12 right-0 w-10 h-10 rounded-full bg-white/10 flex items-center justify-center text-white hover:bg-white/20 transition",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("img",{src:n(t.url),alt:"娃图",className:"max-w-full max-h-[80vh] rounded-xl object-contain"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/80 to-transparent rounded-b-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(l,{to:"/u/".concat(t.ownerCode),className:"flex items-center gap-3 hover:opacity-80 transition",onClick:e=>e.stopPropagation(),children:[e.jsx("img",{src:n(t.ownerAvatar)||o,alt:t.ownerName,className:"w-10 h-10 rounded-full object-cover border-2 border-white/20",onError:r}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.ownerName}),e.jsx("p",{className:"text-white/60 text-sm",children:"点击查看主页"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1 text-white/80",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),e.jsx("span",{children:t.likeCount})]}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-pink-500/20 hover:bg-pink-500/30 rounded-lg text-pink-400 text-sm font-medium transition",children:"取消收藏"})]})]})})]})})}export{c as default};
