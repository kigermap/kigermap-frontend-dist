import{j as e}from"./query-DSsWWIdM.js";import{a as r}from"./sentry-DvvTOdwe.js";import{a as t,j as s,b as l}from"./index-D0yqgRjz.js";import{a as o,L as a}from"./router-jbVFofSC.js";import"./store-BXxpTH1V.js";const i=["cosplay","kigurumi","outdoor","indoor","event","scenic","urban","nature","temple","beach","park","convention"];function n(){const{t:n}=t(),c=o(),d=r.useRef(null),[h,x]=r.useState(""),[u,g]=r.useState(""),[p,m]=r.useState([]),[v,b]=r.useState([]),[j,f]=r.useState(""),[k,y]=r.useState(0),[N,w]=r.useState(0),[L,C]=r.useState(""),[M,S]=r.useState(""),[W,B]=r.useState(""),[z,D]=r.useState(!1),[q,F]=r.useState(!1),[P,T]=r.useState(!1),[A,H]=r.useState(""),[R,E]=r.useState(!1),O=async e=>{if(p.length+e.length>5)H(n("highlights.maxPhotos").replace("{n}",String(5)));else{D(!0),H("");try{for(const r of Array.from(e)){if(r.size>20971520){H(n("highlights.fileTooLarge"));continue}const e=new FormData;e.append("file",r);const t=await l.post("/oss/upload/highlight",e,{headers:{"Content-Type":"multipart/form-data"}});m(e=>[...e,t.data.url])}}catch(r){H(n("highlights.uploadFailed"))}finally{D(!1)}}},V=e=>{const r=e.trim().replace(/^#/,"");r&&v.length<10&&!v.includes(r)&&b(e=>[...e,r]),f("")},G=h.trim()&&p.length>0&&(0!==k||0!==N)&&!q;return e.jsx("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-6 md:py-10",children:[e.jsxs("nav",{className:"flex items-center gap-2 text-xs mb-6",style:{color:"var(--color-text-muted)"},children:[e.jsx(a,{to:"/highlights",className:"hover:text-purple-400 transition-colors",children:n("highlights.title")}),e.jsx("svg",{className:"w-3 h-3 opacity-40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),e.jsx("span",{style:{color:"var(--color-text)"},children:n("highlights.createTitle")})]}),A&&e.jsxs("div",{className:"mb-6 flex items-center gap-3 p-4 rounded-2xl text-sm",style:{background:"rgba(239,68,68,0.08)",border:"1px solid rgba(239,68,68,0.15)",color:"#ef4444"},children:[e.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"flex-1",children:A}),e.jsx("button",{onClick:()=>H(""),className:"flex-shrink-0 opacity-60 hover:opacity-100 transition-opacity",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr,340px] gap-6 lg:gap-8",children:[e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"rounded-2xl p-5",style:{background:"var(--card-bg)",border:"1px solid var(--glass-border)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",style:{color:"var(--color-text)"},children:[e.jsx("svg",{className:"w-4 h-4 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),n("highlights.photos")," ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-md",style:{background:"var(--hover-bg)",color:"var(--color-text-muted)"},children:[p.length,"/",5]})]}),0===p.length?e.jsx("div",{onDragOver:e=>{e.preventDefault(),E(!0)},onDragLeave:()=>E(!1),onDrop:e=>{e.preventDefault(),E(!1),e.dataTransfer.files.length>0&&O(e.dataTransfer.files)},onClick:()=>{var e;return null==(e=d.current)?void 0:e.click()},className:"relative rounded-xl cursor-pointer transition-all duration-200 flex flex-col items-center justify-center py-12 gap-3",style:{border:R?"2px dashed #8b5cf6":"2px dashed var(--glass-border)",background:R?"rgba(139,92,246,0.05)":"transparent"},children:z?e.jsx("div",{className:"w-8 h-8 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center",style:{background:"rgba(139,92,246,0.1)"},children:e.jsx("svg",{className:"w-6 h-6 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--color-text)"},children:n("highlights.dragOrClick")}),e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--color-text-muted)"},children:n("highlights.photoHint")})]})]})}):e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-5 gap-2.5",children:[p.map((r,t)=>e.jsxs("div",{className:"relative aspect-square rounded-xl overflow-hidden group",style:{border:"1px solid var(--glass-border)"},children:[e.jsx("img",{src:r,alt:"",className:"w-full h-full object-cover",onError:s}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-colors"}),e.jsx("button",{onClick:()=>m(e=>e.filter((e,r)=>r!==t)),className:"absolute top-1.5 right-1.5 w-6 h-6 rounded-full bg-black/60 backdrop-blur-sm flex items-center justify-center text-white opacity-0 group-hover:opacity-100 transition-all hover:bg-red-500",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),0===t&&e.jsx("div",{className:"absolute bottom-1.5 left-1.5 px-1.5 py-0.5 rounded text-[9px] font-medium bg-purple-500 text-white",children:n("highlights.cover")})]},t)),p.length<5&&e.jsx("button",{onClick:()=>{var e;return null==(e=d.current)?void 0:e.click()},disabled:z,className:"aspect-square rounded-xl flex flex-col items-center justify-center gap-1.5 transition-all hover:border-purple-400/50",style:{border:"2px dashed var(--glass-border)",color:"var(--color-text-muted)"},children:z?e.jsx("div",{className:"w-5 h-5 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 4v16m8-8H4"})})})]}),e.jsx("input",{ref:d,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:e=>e.target.files&&O(e.target.files)})]}),e.jsxs("div",{className:"rounded-2xl p-5 space-y-4",style:{background:"var(--card-bg)",border:"1px solid var(--glass-border)"},children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-semibold uppercase tracking-wider mb-2",style:{color:"var(--color-text-muted)"},children:[n("highlights.titleLabel")," ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:h,onChange:e=>x(e.target.value),maxLength:100,placeholder:n("highlights.titlePlaceholder"),className:"w-full h-11 px-4 rounded-xl text-sm outline-none transition-all focus:ring-2 focus:ring-purple-500/20",style:{background:"var(--input-bg)",border:"1px solid var(--glass-border)",color:"var(--color-text)"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold uppercase tracking-wider mb-2",style:{color:"var(--color-text-muted)"},children:n("highlights.descriptionLabel")}),e.jsx("textarea",{value:u,onChange:e=>g(e.target.value),maxLength:2e3,rows:5,placeholder:n("highlights.descriptionPlaceholder"),className:"w-full px-4 py-3 rounded-xl text-sm outline-none resize-none transition-all focus:ring-2 focus:ring-purple-500/20",style:{background:"var(--input-bg)",border:"1px solid var(--glass-border)",color:"var(--color-text)"}}),e.jsxs("div",{className:"text-right text-[10px] mt-1",style:{color:"var(--color-text-muted)"},children:[u.length,"/2000"]})]})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"rounded-2xl p-5",style:{background:"var(--card-bg)",border:"1px solid var(--glass-border)"},children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2 mb-4",style:{color:"var(--color-text)"},children:[e.jsxs("svg",{className:"w-4 h-4 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),n("highlights.locationLabel")," ",e.jsx("span",{className:"text-red-400",children:"*"})]}),0!==k?e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl mb-3",style:{background:"rgba(34,197,94,0.08)",border:"1px solid rgba(34,197,94,0.15)"},children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-green-500/15 flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",style:{color:"var(--color-text)"},children:W||M||L}),e.jsx("p",{className:"text-[10px]",style:{color:"var(--color-text-muted)"},children:n("highlights.locationGranularity")})]})]}):null,e.jsxs("button",{onClick:()=>{navigator.geolocation?(T(!0),navigator.geolocation.getCurrentPosition(async e=>{const{latitude:r,longitude:t}=e.coords;y(r),w(t);try{const e=(await l.post("/geo/reverse",{lat:r,lng:t})).data;C(e.country||""),S(e.province||""),B(e.city||"")}catch(s){}T(!1)},()=>{H(n("highlights.geoFailed")),T(!1)},{enableHighAccuracy:!0,timeout:1e4})):H(n("highlights.geoNotSupported"))},disabled:P,className:"w-full flex items-center justify-center gap-2 h-10 rounded-xl text-sm font-medium transition-all active:scale-95",style:{background:0!==k?"var(--hover-bg)":"linear-gradient(135deg, rgba(139,92,246,0.1), rgba(236,72,153,0.1))",border:"1px solid var(--glass-border)",color:"var(--color-text)"},children:[P?e.jsx("div",{className:"w-4 h-4 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"}):e.jsxs("svg",{className:"w-4 h-4 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),n(0!==k?"highlights.relocate":"highlights.getLocation")]})]}),e.jsxs("div",{className:"rounded-2xl p-5",style:{background:"var(--card-bg)",border:"1px solid var(--glass-border)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",style:{color:"var(--color-text)"},children:[e.jsx("svg",{className:"w-4 h-4 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),n("highlights.tagsLabel")]}),e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-md",style:{background:"var(--hover-bg)",color:"var(--color-text-muted)"},children:[v.length,"/10"]})]}),v.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-3",children:v.map(r=>e.jsxs("span",{className:"flex items-center gap-1 px-2.5 py-1 rounded-lg text-xs font-medium",style:{background:"linear-gradient(135deg, rgba(139,92,246,0.12), rgba(236,72,153,0.12))",color:"var(--color-text)"},children:["#",r,e.jsx("button",{onClick:()=>b(e=>e.filter(e=>e!==r)),className:"ml-0.5 opacity-50 hover:opacity-100 hover:text-red-400 transition-all",children:"Ã—"})]},r))}),e.jsx("input",{type:"text",value:j,onChange:e=>f(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),V(j))},placeholder:n("highlights.tagPlaceholder"),className:"w-full h-9 px-3 rounded-lg text-xs outline-none transition-all focus:ring-2 focus:ring-purple-500/20 mb-2.5",style:{background:"var(--input-bg)",border:"1px solid var(--glass-border)",color:"var(--color-text)"}}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:i.filter(e=>!v.includes(e)).slice(0,8).map(r=>e.jsxs("button",{onClick:()=>V(r),className:"px-2 py-1 rounded-lg text-[10px] transition-all hover:bg-purple-500/10 hover:text-purple-400",style:{background:"var(--hover-bg)",color:"var(--color-text-muted)"},children:["+",r]},r))})]}),e.jsx("div",{className:"rounded-2xl p-4",style:{background:"rgba(139,92,246,0.06)",border:"1px solid rgba(139,92,246,0.12)"},children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-500/15 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("svg",{className:"w-4 h-4 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"var(--color-text)"},children:n("highlights.reviewNotice")}),e.jsx("p",{className:"text-[11px] leading-relaxed",style:{color:"var(--color-text-muted)"},children:n("highlights.reviewNoticeDesc")})]})]})}),e.jsx("button",{onClick:async()=>{var e,r;if(h.trim())if(0!==p.length)if(0!==k||0!==N){F(!0),H("");try{await l.post("/highlights",{title:h.trim(),description:u.trim(),photos:p,lat:k,lng:N,country:L,province:M,city:W,tags:v}),c("/highlights",{replace:!0})}catch(t){H((null==(r=null==(e=t.response)?void 0:e.data)?void 0:r.error)||n("highlights.submitFailed"))}finally{F(!1)}}else H(n("highlights.locationRequired"));else H(n("highlights.photosRequired"));else H(n("highlights.titleRequired"))},disabled:!G,className:"w-full h-12 rounded-2xl text-sm font-semibold text-white transition-all active:scale-[0.98] disabled:opacity-40 disabled:cursor-not-allowed",style:{background:G?"linear-gradient(135deg, #8b5cf6, #a855f7, #ec4899)":"var(--hover-bg)",boxShadow:G?"0 4px 20px rgba(139,92,246,0.3)":"none",color:G?"#fff":"var(--color-text-muted)"},children:q?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),n("highlights.submitting")]}):n("highlights.submit")})]})]})]})})}export{n as default};
