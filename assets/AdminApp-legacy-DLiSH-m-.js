!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function s(e){for(var s=1;s<arguments.length;s++){var n=null!=arguments[s]?arguments[s]:{};s%2?t(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(t,s,r){return(s=function(t){var s=function(t,s){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,s||"default");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(t)}(t,"string");return"symbol"==e(s)?s:s+""}(s))in t?Object.defineProperty(t,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[s]=r,t}function n(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,s="function"==typeof Symbol?Symbol:{},r=s.iterator||"@@iterator",n=s.toStringTag||"@@toStringTag";function i(s,r,n,a){var i=r&&r.prototype instanceof d?r:d,o=Object.create(i.prototype);return l(o,"_invoke",function(s,r,n){var a,l,i,d=0,o=n||[],x=!1,u={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,s){return a=t,l=0,i=e,u.n=s,c}};function m(s,r){for(l=s,i=r,t=0;!x&&d&&!n&&t<o.length;t++){var n,a=o[t],m=u.p,p=a[2];s>3?(n=p===r)&&(i=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=m&&((n=s<2&&m<a[1])?(l=0,u.v=r,u.n=a[1]):m<p&&(n=s<3||a[0]>r||r>p)&&(a[4]=s,a[5]=r,u.n=p,l=0))}if(n||s>1)return c;throw x=!0,r}return function(n,o,p){if(d>1)throw TypeError("Generator is already running");for(x&&1===o&&m(o,p),l=o,i=p;(t=l<2?e:i)||!x;){a||(l?l<3?(l>1&&(u.n=-1),m(l,i)):u.n=i:u.v=i);try{if(d=2,a){if(l||(n="next"),t=a[n]){if(!(t=t.call(a,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(i=TypeError("The iterator does not provide a '"+n+"' method"),l=1);a=e}else if((t=(x=u.n<0)?i:s.call(r,u))!==c)break}catch(t){a=e,l=1,i=t}finally{d=1}}return{value:t,done:x}}}(s,n,a),!0),o}var c={};function d(){}function o(){}function x(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(l(t={},r,function(){return this}),t),m=x.prototype=d.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,l(e,n,"GeneratorFunction")),e.prototype=Object.create(m),e}return o.prototype=x,l(m,"constructor",x),l(x,"constructor",o),o.displayName="GeneratorFunction",l(x,n,"GeneratorFunction"),l(m),l(m,n,"Generator"),l(m,r,function(){return this}),l(m,"toString",function(){return"[object Generator]"}),(a=function(){return{w:i,m:p}})()}function l(e,t,s,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}l=function(e,t,s,r){function a(t,s){l(e,t,function(e){return this._invoke(t,s,e)})}t?n?n(e,t,{value:s,enumerable:!r,configurable:!r,writable:!r}):e[t]=s:(a("next",0),a("throw",1),a("return",2))},l(e,t,s,r)}function i(e,t,s,r,n,a,l){try{var i=e[a](l),c=i.value}catch(e){return void s(e)}i.done?t(c):Promise.resolve(c).then(r,n)}function c(e){return function(){var t=this,s=arguments;return new Promise(function(r,n){var a=e.apply(t,s);function l(e){i(a,r,n,l,c,"next",e)}function c(e){i(a,r,n,l,c,"throw",e)}l(void 0)})}}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var s=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=s){var r,n,a,l,i=[],c=!0,d=!1;try{if(a=(s=s.call(e)).next,0===t){if(Object(s)!==s)return;c=!1}else for(;!(c=(r=a.call(s)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){d=!0,n=e}finally{try{if(!c&&null!=s.return&&(l=s.return(),Object(l)!==l))return}finally{if(d)throw n}}return i}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return x(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?x(e,t):void 0}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}System.register(["./query-legacy-CLxXWLnl.js","./index-legacy-DVoFAd51.js","./sentry-legacy-CTr2CudU.js","./router-legacy-9xrJEksD.js","./CustomSelect-legacy-k9C_XkzF.js","./store-legacy-Bt3CCSnU.js"],function(e,t){"use strict";var l,i,o,x,u,m,p,h,g,f,b,y,j,v,N,w,k;return{setters:[function(e){l=e.j,i=e.b,o=e.u,x=e.c},function(e){u=e.u,m=e.l,p=e.b,h=e.e,g=e.g},function(e){f=e.a},function(e){b=e.u,y=e.a,j=e.L,v=e.R,N=e.b,w=e.N},function(e){k=e.A},null],execute:function(){e("default",function(){return l.jsxs(v,{children:[l.jsx(N,{path:"login",element:l.jsx(W,{})}),l.jsx(N,{path:"/*",element:l.jsx(Y,{children:l.jsx(C,{children:l.jsxs(v,{children:[l.jsx(N,{index:!0,element:l.jsx(S,{})}),l.jsx(N,{path:"users",element:l.jsx(P,{})}),l.jsx(N,{path:"shops",element:l.jsx(I,{})}),l.jsx(N,{path:"feedbacks",element:l.jsx(F,{})}),l.jsx(N,{path:"notifications",element:l.jsx(K,{})}),l.jsx(N,{path:"push",element:l.jsx($,{})}),l.jsx(N,{path:"versions",element:l.jsx(J,{})}),l.jsx(N,{path:"security",element:l.jsx(U,{})}),l.jsx(N,{path:"images",element:l.jsx(z,{})}),l.jsx(N,{path:"reports",element:l.jsx(B,{})}),l.jsx(N,{path:"highlights",element:l.jsx(V,{})}),l.jsx(N,{path:"*",element:l.jsx(w,{to:"/admin",replace:!0})})]})})})})]})});var t=[{path:"/admin",label:"ä»ªè¡¨ç›˜",icon:"ğŸ“Š",roles:["admin","reviewer","ops"]},{path:"/admin/users",label:"ç”¨æˆ·ç®¡ç†",icon:"ğŸ‘¥",roles:["admin","ops"]},{path:"/admin/shops",label:"å·¥åŠç®¡ç†",icon:"ğŸª",roles:["admin","reviewer"]},{path:"/admin/images",label:"å›¾ç‰‡å®¡æ ¸",icon:"ğŸ–¼ï¸",roles:["admin","ops","reviewer"]},{path:"/admin/reports",label:"ä¸¾æŠ¥ç®¡ç†",icon:"ğŸš©",roles:["admin","ops","reviewer"]},{path:"/admin/highlights",label:"ç²¾å½©æ—¶åˆ»å®¡æ ¸",icon:"âœ¨",roles:["admin","ops","reviewer"]},{path:"/admin/feedbacks",label:"åé¦ˆç®¡ç†",icon:"ğŸ’¬",roles:["admin","ops","reviewer"]},{path:"/admin/notifications",label:"é€šçŸ¥ç®¡ç†",icon:"ğŸ””",roles:["admin","ops"]},{path:"/admin/push",label:"æ¨é€ç®¡ç†",icon:"ğŸ“¤",roles:["admin","ops"]},{path:"/admin/versions",label:"ç‰ˆæœ¬ç®¡ç†",icon:"ğŸ“±",roles:["admin","ops"]},{path:"/admin/security",label:"å®‰å…¨ç®¡ç†",icon:"ğŸ”’",roles:["admin","ops"]}];function C(e){var s,r,n=e.children,a=b(),i=y(),c=u(),o=c.user,x=c.logout,p=d(f.useState(!1),2),h=p[0],g=p[1],v=t.filter(function(e){return e.roles.includes((null==o?void 0:o.role)||"")});return l.jsxs("div",{className:"min-h-screen bg-gray-900",children:[l.jsxs("div",{className:"lg:hidden bg-gray-800 border-b border-gray-700 px-4 py-3 flex items-center justify-between",children:[l.jsx("button",{onClick:function(){return g(!h)},className:"text-gray-400 hover:text-white",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),l.jsx("span",{className:"text-white font-semibold",children:"ç®¡ç†åå°"}),l.jsx("div",{className:"w-6"})]}),l.jsxs("div",{className:"flex",children:[l.jsx("aside",{className:"\n          fixed lg:static inset-y-0 left-0 z-50\n          w-64 bg-gray-800 border-r border-gray-700\n          transform transition-transform duration-200 ease-in-out\n          ".concat(h?"translate-x-0":"-translate-x-full lg:translate-x-0","\n        "),children:l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"p-4 border-b border-gray-700",children:[l.jsxs(j,{to:"https://kighub.cn/",className:"flex items-center gap-2 text-white",children:[l.jsx("img",{src:m,alt:"Logo",className:"w-8 h-8"}),l.jsx("span",{className:"font-bold",children:"Kigurumi Map"})]}),l.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"ç®¡ç†åå°"})]}),l.jsx("div",{className:"p-4 border-b border-gray-700",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-600 flex items-center justify-center text-white font-bold",children:(null==o||null===(s=o.email)||void 0===s||null===(s=s[0])||void 0===s?void 0:s.toUpperCase())||"A"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm text-white truncate",children:null==o?void 0:o.email}),l.jsx("p",{className:"text-xs text-purple-400",children:(r=(null==o?void 0:o.role)||"",{admin:"ç®¡ç†å‘˜",shop_owner:"å·¥åŠç®¡ç†å‘˜",reviewer:"å®¡æ ¸å‘˜",ops:"è¿ç»´"}[r]||r)})]})]})}),l.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:v.map(function(e){return l.jsxs(j,{to:e.path,onClick:function(){return g(!1)},className:"\n                    flex items-center gap-3 px-3 py-2 rounded-lg transition-colors\n                    ".concat(a.pathname===e.path?"bg-purple-600 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","\n                  "),children:[l.jsx("span",{children:e.icon}),l.jsx("span",{children:e.label})]},e.path)})}),l.jsxs("div",{className:"p-4 border-t border-gray-700 space-y-2",children:[l.jsxs(j,{to:"https://kighub.cn/",className:"flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-700 hover:text-white transition-colors",children:[l.jsx("span",{children:"ğŸ "}),l.jsx("span",{children:"è¿”å›å‰å°"})]}),l.jsxs("button",{onClick:function(){x(),i("/admin/login")},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-red-400 hover:bg-red-900/30 transition-colors",children:[l.jsx("span",{children:"ğŸšª"}),l.jsx("span",{children:"é€€å‡ºç™»å½•"})]})]})]})}),h&&l.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:function(){return g(!1)}}),l.jsx("main",{className:"flex-1 min-h-screen lg:min-h-[calc(100vh)]",children:l.jsx("div",{className:"p-4 lg:p-6",children:n})})]})]})}function S(){var e,t=u().user,s=i({queryKey:["admin-dashboard"],queryFn:(e=c(a().m(function e(){var t;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.get("/admin/dashboard");case 1:return t=e.v,e.a(2,t.data)}},e)})),function(){return e.apply(this,arguments)})}),r=s.data,n=s.isLoading,d=s.error,o=null==r?void 0:r.stats,x=[{label:"æ€»ç”¨æˆ·æ•°",value:(null==o?void 0:o.totalUsers)||0,icon:"ğŸ‘¥",color:"from-blue-500 to-blue-600",roles:["admin","ops"]},{label:"å·²åˆ›å»ºèµ„æ–™",value:(null==o?void 0:o.totalProfiles)||0,icon:"ğŸ“",color:"from-green-500 to-green-600",roles:["admin","ops"]},{label:"ç…§ç‰‡æ€»æ•°",value:(null==o?void 0:o.totalPhotos)||0,icon:"ğŸ“·",color:"from-cyan-500 to-cyan-600",roles:["admin","ops"]},{label:"ä»Šæ—¥æ–°å¢",value:(null==o?void 0:o.newUsersToday)||0,icon:"ğŸ“ˆ",color:"from-purple-500 to-purple-600",roles:["admin","ops"]},{label:"å·¥åŠæ€»æ•°",value:(null==o?void 0:o.totalShops)||0,icon:"ğŸª",color:"from-orange-500 to-orange-600",roles:["admin","reviewer","shop_owner"]},{label:"è¥ä¸šä¸­å·¥åŠ",value:(null==o?void 0:o.activeShops)||0,icon:"âœ…",color:"from-teal-500 to-teal-600",roles:["admin","reviewer","shop_owner"]},{label:"å¾…å¤„ç†åé¦ˆ",value:(null==o?void 0:o.pendingFeedbacks)||0,icon:"ğŸ’¬",color:"from-yellow-500 to-yellow-600",roles:["admin","ops","reviewer"]},{label:"å°ç¦IPæ•°",value:(null==o?void 0:o.blockedIPs)||0,icon:"ğŸš«",color:"from-red-500 to-red-600",roles:["admin","ops"]},{label:"ä»Šæ—¥ç™»å½•å¤±è´¥",value:(null==o?void 0:o.failedLoginsToday)||0,icon:"âš ï¸",color:"from-pink-500 to-pink-600",roles:["admin","ops"]}].filter(function(e){return e.roles.includes((null==t?void 0:t.role)||"")});return n?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):d?l.jsx("div",{className:"bg-red-900/30 border border-red-500/50 rounded-lg p-4 text-red-400",children:"åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•"}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"ä»ªè¡¨ç›˜"}),l.jsx("p",{className:"text-gray-400 mt-1",children:"ç³»ç»Ÿæ¦‚è§ˆå’Œç»Ÿè®¡æ•°æ®"})]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:x.map(function(e,t){return l.jsx("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 hover:border-gray-600 transition-colors",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-400 text-sm",children:e.label}),l.jsx("p",{className:"text-3xl font-bold text-white mt-1",children:e.value.toLocaleString()})]}),l.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br ".concat(e.color," flex items-center justify-center text-2xl"),children:e.icon})]})},t)})}),l.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700",children:[l.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"å¿«æ·æ“ä½œ"}),l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:["admin"===(null==t?void 0:t.role)||"ops"===(null==t?void 0:t.role)?l.jsxs("a",{href:"/admin/users",className:"flex flex-col items-center gap-2 p-4 bg-gray-700/50 rounded-lg hover:bg-gray-700 transition-colors",children:[l.jsx("span",{className:"text-2xl",children:"ğŸ‘¥"}),l.jsx("span",{className:"text-sm text-gray-300",children:"ç®¡ç†ç”¨æˆ·"})]}):null,"admin"===(null==t?void 0:t.role)||"reviewer"===(null==t?void 0:t.role)||"shop_owner"===(null==t?void 0:t.role)?l.jsxs("a",{href:"/admin/shops",className:"flex flex-col items-center gap-2 p-4 bg-gray-700/50 rounded-lg hover:bg-gray-700 transition-colors",children:[l.jsx("span",{className:"text-2xl",children:"ğŸª"}),l.jsx("span",{className:"text-sm text-gray-300",children:"ç®¡ç†å·¥åŠ"})]}):null,"admin"===(null==t?void 0:t.role)||"ops"===(null==t?void 0:t.role)||"reviewer"===(null==t?void 0:t.role)?l.jsxs("a",{href:"/admin/feedbacks",className:"flex flex-col items-center gap-2 p-4 bg-gray-700/50 rounded-lg hover:bg-gray-700 transition-colors",children:[l.jsx("span",{className:"text-2xl",children:"ğŸ’¬"}),l.jsx("span",{className:"text-sm text-gray-300",children:"å¤„ç†åé¦ˆ"})]}):null,"admin"===(null==t?void 0:t.role)||"ops"===(null==t?void 0:t.role)?l.jsxs("a",{href:"/admin/security",className:"flex flex-col items-center gap-2 p-4 bg-gray-700/50 rounded-lg hover:bg-gray-700 transition-colors",children:[l.jsx("span",{className:"text-2xl",children:"ğŸ”’"}),l.jsx("span",{className:"text-sm text-gray-300",children:"å®‰å…¨ç®¡ç†"})]}):null]})]}),l.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700",children:[l.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"ç³»ç»Ÿä¿¡æ¯"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-700",children:[l.jsx("span",{className:"text-gray-400",children:"å½“å‰ç”¨æˆ·"}),l.jsx("span",{className:"text-white",children:null==t?void 0:t.email})]}),l.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-700",children:[l.jsx("span",{className:"text-gray-400",children:"è§’è‰²"}),l.jsxs("span",{className:"text-purple-400",children:["admin"===(null==t?void 0:t.role)&&"ç®¡ç†å‘˜","shop_owner"===(null==t?void 0:t.role)&&"å·¥åŠç®¡ç†å‘˜","reviewer"===(null==t?void 0:t.role)&&"å®¡æ ¸å‘˜","ops"===(null==t?void 0:t.role)&&"è¿ç»´"]})]}),l.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-700",children:[l.jsx("span",{className:"text-gray-400",children:"ç³»ç»Ÿç‰ˆæœ¬"}),l.jsx("span",{className:"text-white",children:"v2.0.0"})]}),l.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-700",children:[l.jsx("span",{className:"text-gray-400",children:"åç«¯"}),l.jsx("span",{className:"text-white",children:"Go + Fiber"})]})]})]})]})}function P(){var e,t,s,r,u,m=o(),b=h({position:"center"}),y=b.showNotification,j=b.NotificationComponent,v=d(f.useState(1),2),N=v[0],w=v[1],C=d(f.useState(""),2),S=C[0],P=C[1],I=d(f.useState(""),2),q=I[0],A=I[1],F=d(f.useState(!1),2),L=F[0],U=F[1],K=d(f.useState(null),2),O=K[0],T=K[1],D=d(f.useState(!1),2),z=D[0],M=D[1],R=d(f.useState(!1),2),Q=R[0],_=R[1],E=d(f.useState(!1),2),B=E[0],V=E[1],G=d(f.useState(""),2),W=G[0],$=G[1],H=d(f.useState(""),2),J=H[0],X=H[1],Y=d(f.useState(""),2),Z=Y[0],ee=Y[1],te=d(f.useState([]),2),se=te[0],re=te[1],ne=i({queryKey:["admin-users",N,S,q,L],queryFn:(e=c(a().m(function e(){var t,s;return a().w(function(e){for(;;)switch(e.n){case 0:return(t=new URLSearchParams).append("page",N.toString()),t.append("limit","20"),S&&t.append("search",S),q&&t.append("role",q),L&&t.append("bannedOnly","true"),e.n=1,p.get("/admin/users?".concat(t));case 1:return s=e.v,e.a(2,s.data)}},e)})),function(){return e.apply(this,arguments)})}),ae=ne.data,le=ne.isLoading,ie=x({mutationFn:(t=c(a().m(function e(t){var s,r;return a().w(function(e){for(;;)switch(e.n){case 0:return s=t.userId,r=t.roles,e.n=1,p.put("/admin/users/".concat(s,"/roles"),{roles:r});case 1:return e.a(2)}},e)})),function(e){return t.apply(this,arguments)}),onSuccess:function(){m.invalidateQueries({queryKey:["admin-users"]}),V(!1),T(null),re([])}}),ce=x({mutationFn:(s=c(a().m(function e(t){var s,r,n;return a().w(function(e){for(;;)switch(e.n){case 0:return s=t.userId,r=t.reason,n=t.expiresAt,e.n=1,p.post("/admin/users/".concat(s,"/ban"),{reason:r,expiresAt:n});case 1:return e.a(2)}},e)})),function(e){return s.apply(this,arguments)}),onSuccess:function(){m.invalidateQueries({queryKey:["admin-users"]}),M(!1),$(""),X(""),T(null)}}),de=x({mutationFn:(r=c(a().m(function e(t){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.post("/admin/users/".concat(t,"/unban"));case 1:return e.a(2)}},e)})),function(e){return r.apply(this,arguments)}),onSuccess:function(){m.invalidateQueries({queryKey:["admin-users"]})}}),oe=x({mutationFn:(u=c(a().m(function e(t){var s,r;return a().w(function(e){for(;;)switch(e.n){case 0:return s=t.userId,r=t.newPassword,e.n=1,p.post("/admin/users/".concat(s,"/reset-password"),{newPassword:r});case 1:return e.a(2)}},e)})),function(e){return u.apply(this,arguments)}),onSuccess:function(){m.invalidateQueries({queryKey:["admin-users"]}),_(!1),ee(""),T(null),y("å¯†ç å·²é‡ç½®","success")}}),xe={user:"æ™®é€šç”¨æˆ·",shop_owner:"å·¥åŠç®¡ç†å‘˜",reviewer:"å®¡æ ¸å‘˜",ops:"è¿ç»´",admin:"ç®¡ç†å‘˜"},ue={user:"bg-gray-600",shop_owner:"bg-blue-600",reviewer:"bg-green-600",ops:"bg-yellow-600",admin:"bg-purple-600"};return l.jsxs("div",{className:"space-y-6",children:[j,l.jsx("div",{className:"flex justify-between items-center",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"ç”¨æˆ·ç®¡ç†"}),l.jsx("p",{className:"text-gray-400 mt-1",children:"ç®¡ç†ç”¨æˆ·è´¦æˆ·ã€è§’è‰²å’Œæƒé™"})]})}),l.jsxs("div",{className:"flex flex-wrap gap-4",children:[l.jsx("input",{type:"text",placeholder:"æœç´¢é‚®ç®±ã€æ‰‹æœºå·æˆ–CNå...",value:S,onChange:function(e){P(e.target.value),w(1)},className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-purple-500"}),l.jsx(k,{value:q,onChange:function(e){A(e),w(1)},options:[{value:"",label:"å…¨éƒ¨è§’è‰²"},{value:"user",label:"æ™®é€šç”¨æˆ·"},{value:"shop_owner",label:"å·¥åŠç®¡ç†å‘˜"},{value:"reviewer",label:"å®¡æ ¸å‘˜"},{value:"ops",label:"è¿ç»´"},{value:"admin",label:"ç®¡ç†å‘˜"}],className:"w-36"}),l.jsxs("label",{className:"flex items-center gap-2 text-gray-300",children:[l.jsx("input",{type:"checkbox",checked:L,onChange:function(e){U(e.target.checked),w(1)},className:"w-4 h-4 rounded bg-gray-700 border-gray-600"}),"ä»…æ˜¾ç¤ºå°ç¦ç”¨æˆ·"]})]}),l.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-900",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"ç”¨æˆ·"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"è§’è‰²"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"çŠ¶æ€"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"æ³¨å†Œæ—¶é—´"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-400",children:"æ“ä½œ"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-700",children:le?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:"åŠ è½½ä¸­..."})}):0===(null==ae?void 0:ae.users.length)?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:"æš‚æ— æ•°æ®"})}):null==ae?void 0:ae.users.map(function(e){var t;return l.jsxs("tr",{className:"hover:bg-gray-700/50",children:[l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{className:"flex items-center gap-3",children:[e.avatar?l.jsx("img",{src:g(e.avatar),alt:"",className:"w-10 h-10 rounded-lg object-cover"}):l.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-700 flex items-center justify-center text-gray-400",children:(null===(t=e.email||e.phone)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.toUpperCase())||"?"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-white font-medium",children:e.cnName||"æœªè®¾ç½®"}),e.email&&l.jsx("p",{className:"text-gray-400 text-sm",children:e.email}),e.phone&&l.jsxs("p",{className:"text-gray-400 text-sm",children:["ğŸ“± ",e.phone]}),!e.email&&!e.phone&&l.jsx("p",{className:"text-gray-500 text-sm",children:"æ— è”ç³»æ–¹å¼"})]})]})}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("div",{className:"flex flex-wrap gap-1",children:(e.roles||[e.role]).map(function(e){return l.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium text-white ".concat(ue[e]||"bg-gray-600"),children:xe[e]||e},e)})})}),l.jsx("td",{className:"px-4 py-3",children:e.isBanned?l.jsxs("div",{children:[l.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-red-600 text-white",children:"å·²å°ç¦"}),e.banReason&&l.jsxs("p",{className:"text-xs text-gray-400 mt-1",title:e.banReason,children:[e.banReason.slice(0,20),"..."]})]}):l.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-green-600 text-white",children:"æ­£å¸¸"})}),l.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(e.createdAt).toLocaleDateString()}),l.jsx("td",{className:"px-4 py-3 text-right",children:l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx("button",{onClick:function(){return function(e){T(e),re((e.roles||[e.role]).filter(function(e){return"admin"!==e})),V(!0)}(e)},className:"px-3 py-1 text-xs bg-purple-600 hover:bg-purple-500 text-white rounded",children:"ç¼–è¾‘è§’è‰²"}),e.isBanned?l.jsx("button",{onClick:function(){return de.mutate(e.id)},className:"px-3 py-1 text-xs bg-green-600 hover:bg-green-500 text-white rounded",children:"è§£å°"}):l.jsx("button",{onClick:function(){T(e),M(!0)},className:"px-3 py-1 text-xs bg-red-600 hover:bg-red-500 text-white rounded",children:"å°ç¦"}),l.jsx("button",{onClick:function(){T(e),_(!0)},className:"px-3 py-1 text-xs bg-yellow-600 hover:bg-yellow-500 text-white rounded",children:"é‡ç½®å¯†ç "}),e.shareCode&&l.jsx("a",{href:"/u/".concat(e.shareCode),target:"_blank",rel:"noopener noreferrer",className:"px-3 py-1 text-xs bg-gray-600 hover:bg-gray-500 text-white rounded",children:"æŸ¥çœ‹ä¸»é¡µ"})]})})]},e.id)})})]})}),ae&&ae.totalPages>1&&l.jsxs("div",{className:"flex justify-center gap-2",children:[l.jsx("button",{onClick:function(){return w(function(e){return Math.max(1,e-1)})},disabled:1===N,className:"px-4 py-2 bg-gray-700 text-white rounded disabled:opacity-50",children:"ä¸Šä¸€é¡µ"}),l.jsxs("span",{className:"px-4 py-2 text-gray-400",children:[N," / ",ae.totalPages]}),l.jsx("button",{onClick:function(){return w(function(e){return Math.min(ae.totalPages,e+1)})},disabled:N===ae.totalPages,className:"px-4 py-2 bg-gray-700 text-white rounded disabled:opacity-50",children:"ä¸‹ä¸€é¡µ"})]}),B&&O&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 w-full max-w-md",children:[l.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"ç¼–è¾‘ç”¨æˆ·è§’è‰²"}),l.jsxs("p",{className:"text-gray-400 mb-4",children:["ä¸º ",O.email||O.phone," åˆ†é…è§’è‰²"]}),(O.roles||[O.role]).includes("admin")&&l.jsx("div",{className:"mb-4 p-3 bg-purple-900/30 border border-purple-700 rounded-lg",children:l.jsx("p",{className:"text-purple-300 text-sm",children:"âš ï¸ è¯¥ç”¨æˆ·æ‹¥æœ‰ç®¡ç†å‘˜è§’è‰²ï¼Œç®¡ç†å‘˜è§’è‰²æ— æ³•é€šè¿‡æ­¤ç•Œé¢ä¿®æ”¹"})}),l.jsx("div",{className:"space-y-3",children:[{value:"user",label:"æ™®é€šç”¨æˆ·",color:"bg-gray-600"},{value:"shop_owner",label:"å·¥åŠç®¡ç†å‘˜",color:"bg-blue-600"},{value:"reviewer",label:"å®¡æ ¸å‘˜",color:"bg-green-600"},{value:"ops",label:"è¿ç»´",color:"bg-yellow-600"}].map(function(e){return l.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-700 rounded-lg cursor-pointer hover:bg-gray-600",children:[l.jsx("input",{type:"checkbox",checked:se.includes(e.value),onChange:function(){return function(e){se.includes(e)?re(se.filter(function(t){return t!==e})):re([].concat(n(se),[e]))}(e.value)},className:"w-5 h-5 rounded bg-gray-600 border-gray-500"}),l.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium text-white ".concat(e.color),children:e.label})]},e.value)})}),l.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[l.jsx("button",{onClick:function(){V(!1),T(null),re([])},className:"px-4 py-2 bg-gray-700 text-white rounded-lg",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:function(){if(O){var e=(O.roles||[O.role]).includes("admin")?[].concat(n(se),["admin"]):se;(0===e.length||1===e.length&&"admin"===e[0])&&e.push("user"),ie.mutate({userId:O.id,roles:e})}},className:"px-4 py-2 bg-purple-600 text-white rounded-lg",children:"ä¿å­˜"})]})]})}),z&&O&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 w-full max-w-md",children:[l.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"å°ç¦ç”¨æˆ·"}),l.jsxs("p",{className:"text-gray-400 mb-4",children:["ç¡®å®šè¦å°ç¦ ",O.email||O.phone," å—ï¼Ÿ"]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"å°ç¦åŸå› "}),l.jsx("textarea",{value:W,onChange:function(e){return $(e.target.value)},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",rows:3,placeholder:"è¯·è¾“å…¥å°ç¦åŸå› ..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"å°ç¦å¤©æ•°ï¼ˆç•™ç©ºä¸ºæ°¸ä¹…ï¼‰"}),l.jsx("input",{type:"number",value:J,onChange:function(e){return X(e.target.value?Number(e.target.value):"")},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"å¤©æ•°",min:1})]})]}),l.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[l.jsx("button",{onClick:function(){M(!1),T(null),$(""),X("")},className:"px-4 py-2 bg-gray-700 text-white rounded-lg",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:function(){if(O&&W){var e=J?new Date(Date.now()+24*Number(J)*60*60*1e3).toISOString():void 0;ce.mutate({userId:O.id,reason:W,expiresAt:e})}},disabled:!W,className:"px-4 py-2 bg-red-600 text-white rounded-lg disabled:opacity-50",children:"ç¡®è®¤å°ç¦"})]})]})}),Q&&O&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 w-full max-w-md",children:[l.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"é‡ç½®å¯†ç "}),l.jsxs("p",{className:"text-gray-400 mb-4",children:["ä¸º ",O.email||O.phone," è®¾ç½®æ–°å¯†ç "]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"æ–°å¯†ç "}),l.jsx("input",{type:"text",value:Z,onChange:function(e){return ee(e.target.value)},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"è‡³å°‘6ä½",minLength:6})]}),l.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[l.jsx("button",{onClick:function(){_(!1),T(null),ee("")},className:"px-4 py-2 bg-gray-700 text-white rounded-lg",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:function(){!O||Z.length<6||oe.mutate({userId:O.id,newPassword:Z})},disabled:Z.length<6,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg disabled:opacity-50",children:"ç¡®è®¤é‡ç½®"})]})]})})]})}function I(){var e,t,s,n,u,m,b=o(),y=h({position:"center"}),v=y.showNotification,N=y.NotificationComponent,w=d(f.useState(1),2),C=w[0],S=w[1],P=d(f.useState(""),2),I=P[0],q=P[1],A=d(f.useState(""),2),F=A[0],L=A[1],U=d(f.useState(""),2),K=U[0],O=U[1],T=d(f.useState(null),2),D=T[0],z=T[1],M=d(f.useState(!1),2),R=M[0],Q=M[1],_=d(f.useState(!1),2),E=_[0],B=_[1],V=d(f.useState(""),2),G=V[0],W=V[1],$=i({queryKey:["admin-shops",C,I,F,K],queryFn:(e=c(a().m(function e(){var t,s;return a().w(function(e){for(;;)switch(e.n){case 0:return t=new URLSearchParams({page:C.toString(),limit:"20"}),I&&t.append("search",I),F&&t.append("isActive",F),K&&t.append("isVerified",K),e.n=1,p.get("/admin/shops?".concat(t));case 1:return s=e.v,e.a(2,s.data)}},e)})),function(){return e.apply(this,arguments)})}),H=$.data,J=$.isLoading,X=i({queryKey:["shop-managers",null==D?void 0:D.id],queryFn:(t=c(a().m(function e(){var t;return a().w(function(e){for(;;)switch(e.n){case 0:if(D){e.n=1;break}return e.a(2,{managers:[]});case 1:return e.n=2,p.get("/admin/shops/".concat(D.id,"/managers"));case 2:return t=e.v,e.a(2,t.data)}},e)})),function(){return t.apply(this,arguments)}),enabled:!!D&&R}),Y=X.data,Z=X.refetch,ee=i({queryKey:["search-users",G],queryFn:(s=c(a().m(function e(){var t;return a().w(function(e){for(;;)switch(e.n){case 0:if(G&&!(G.length<2)){e.n=1;break}return e.a(2,{users:[]});case 1:return e.n=2,p.get("/admin/users?search=".concat(encodeURIComponent(G),"&limit=10"));case 2:return t=e.v,e.a(2,t.data)}},e)})),function(){return s.apply(this,arguments)}),enabled:G.length>=2}),te=ee.data,se=x({mutationFn:(n=c(a().m(function e(t){var s,r;return a().w(function(e){for(;;)switch(e.n){case 0:return s=t.shopId,r=t.updates,e.n=1,p.put("/admin/shops/".concat(s,"/status"),r);case 1:return e.a(2)}},e)})),function(e){return n.apply(this,arguments)}),onSuccess:function(){b.invalidateQueries({queryKey:["admin-shops"]})}}),re=x({mutationFn:(u=c(a().m(function e(t){var s,r,n;return a().w(function(e){for(;;)switch(e.n){case 0:return s=t.shopId,r=t.userId,n=t.role,e.n=1,p.post("/admin/shops/".concat(s,"/managers"),{userId:r,role:n});case 1:return e.a(2)}},e)})),function(e){return u.apply(this,arguments)}),onSuccess:function(){Z(),B(!1),W("")}}),ne=x({mutationFn:(m=c(a().m(function e(t){var s,r;return a().w(function(e){for(;;)switch(e.n){case 0:return s=t.shopId,r=t.userId,e.n=1,p.delete("/admin/shops/".concat(s,"/managers/").concat(r));case 1:return e.a(2)}},e)})),function(e){return m.apply(this,arguments)}),onSuccess:function(){Z()}}),ae=function(e,t){"isVerified"!==t||e.isVerified||e.lat&&e.lng?se.mutate({shopId:e.id,updates:r({},t,!e[t])}):v("åªæœ‰å…¬å¼€ä½ç½®çš„å·¥åŠæ‰èƒ½æˆä¸ºè®¤è¯å·¥åŠ","error")};return l.jsxs("div",{className:"space-y-6",children:[N,l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"å·¥åŠç®¡ç†"}),l.jsx("p",{className:"text-gray-400 mt-1",children:"ç®¡ç†å¤´å£³å·¥åŠ"})]}),l.jsx("div",{className:"bg-gray-800 rounded-xl p-4 border border-gray-700",children:l.jsxs("form",{onSubmit:function(e){e.preventDefault(),S(1)},className:"flex flex-wrap gap-4",children:[l.jsx("input",{type:"text",value:I,onChange:function(e){return q(e.target.value)},placeholder:"æœç´¢å·¥åŠåç§°...",className:"flex-1 min-w-[200px] px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400"}),l.jsx(k,{value:F,onChange:function(e){L(e),S(1)},options:[{value:"",label:"å…¨éƒ¨çŠ¶æ€"},{value:"true",label:"è¥ä¸šä¸­"},{value:"false",label:"å·²å…³é—­"}],className:"w-32"}),l.jsx(k,{value:K,onChange:function(e){O(e),S(1)},options:[{value:"",label:"å…¨éƒ¨è®¤è¯"},{value:"true",label:"å·²è®¤è¯"},{value:"false",label:"æœªè®¤è¯"}],className:"w-32"}),l.jsx("button",{type:"submit",className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"æœç´¢"})]})}),l.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:J?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-700/50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"å·¥åŠ"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"çŠ¶æ€"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"ä½ç½®"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"ç»Ÿè®¡"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"æ“ä½œ"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-700",children:null==H?void 0:H.shops.map(function(e){return l.jsxs("tr",{className:"hover:bg-gray-700/30",children:[l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{className:"flex items-center gap-3",children:[e.logo?l.jsx("img",{src:g(e.logo),alt:"",className:"w-12 h-12 rounded-lg object-cover"}):l.jsx("div",{className:"w-12 h-12 rounded-lg bg-gray-600 flex items-center justify-center text-2xl",children:"ğŸª"}),l.jsxs("div",{children:[l.jsx(j,{to:"/edit-shop/".concat(e.slug),className:"text-white font-medium hover:text-purple-400 transition-colors",children:e.name}),l.jsxs("p",{className:"text-xs text-gray-400",children:["/",e.slug]})]})]})}),l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full ".concat(e.isActive?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"),children:e.isActive?"è¥ä¸šä¸­":"å·²å…³é—­"}),e.isVerified&&l.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-blue-500/20 text-blue-400",children:"å·²è®¤è¯"}),e.isFeatured&&l.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-yellow-500/20 text-yellow-400",children:"æ¨è"})]})}),l.jsx("td",{className:"px-4 py-3",children:e.lat&&e.lng?l.jsx("span",{className:"text-green-400 text-sm",children:"ğŸ“ å·²å…¬å¼€"}):l.jsx("span",{className:"text-gray-500 text-sm",children:"æœªå…¬å¼€"})}),l.jsxs("td",{className:"px-4 py-3 text-sm text-gray-400",children:[l.jsxs("span",{children:["ğŸ‘ ",e.viewCount]}),l.jsxs("span",{className:"ml-3",children:["â¤ï¸ ",e.favoriteCount]})]}),l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{className:"flex gap-2 flex-wrap",children:[l.jsx("button",{onClick:function(){return function(e){z(e),Q(!0)}(e)},className:"px-2 py-1 text-xs rounded bg-purple-500/20 text-purple-400 hover:bg-purple-500/30",children:"ç®¡ç†å‘˜"}),l.jsx("button",{onClick:function(){return ae(e,"isActive")},className:"px-2 py-1 text-xs rounded ".concat(e.isActive?"bg-red-500/20 text-red-400":"bg-green-500/20 text-green-400"),children:e.isActive?"å…³é—­":"å¼€å¯"}),l.jsx("button",{onClick:function(){return ae(e,"isVerified")},className:"px-2 py-1 text-xs rounded bg-blue-500/20 text-blue-400",title:e.lat&&e.lng?"":"éœ€è¦å…¬å¼€ä½ç½®æ‰èƒ½è®¤è¯",children:e.isVerified?"å–æ¶ˆè®¤è¯":"è®¤è¯"}),l.jsx("button",{onClick:function(){return ae(e,"isFeatured")},className:"px-2 py-1 text-xs rounded bg-yellow-500/20 text-yellow-400",children:e.isFeatured?"å–æ¶ˆæ¨è":"æ¨è"})]})})]},e.id)})})]})}),H&&H.totalPages>1&&l.jsxs("div",{className:"px-4 py-3 border-t border-gray-700 flex items-center justify-between",children:[l.jsxs("p",{className:"text-sm text-gray-400",children:["å…± ",H.total," æ¡ï¼Œç¬¬ ",H.page," / ",H.totalPages," é¡µ"]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:function(){return S(function(e){return Math.max(1,e-1)})},disabled:1===C,className:"px-3 py-1 bg-gray-700 text-gray-300 rounded disabled:opacity-50",children:"ä¸Šä¸€é¡µ"}),l.jsx("button",{onClick:function(){return S(function(e){return Math.min(H.totalPages,e+1)})},disabled:C===H.totalPages,className:"px-3 py-1 bg-gray-700 text-gray-300 rounded disabled:opacity-50",children:"ä¸‹ä¸€é¡µ"})]})]})]})}),R&&D&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 w-full max-w-lg max-h-[80vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("h3",{className:"text-lg font-bold text-white",children:[D.name," - ç®¡ç†å‘˜"]}),l.jsx("button",{onClick:function(){Q(!1),z(null)},className:"text-gray-400 hover:text-white",children:"âœ•"})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3",children:"å½“å‰ç®¡ç†å‘˜"}),0===(null==Y?void 0:Y.managers.length)?l.jsx("p",{className:"text-gray-500 text-sm",children:"æš‚æ— ç®¡ç†å‘˜"}):l.jsx("div",{className:"space-y-2",children:null==Y?void 0:Y.managers.map(function(e){return l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-700 rounded-lg",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-white",children:e.userName||"æœªè®¾ç½®æ˜µç§°"}),l.jsx("p",{className:"text-gray-400 text-sm",children:e.userEmail})]}),l.jsx("button",{onClick:function(){return function(e){D&&confirm("ç¡®å®šè¦ç§»é™¤ ".concat(e.userName||e.userEmail," çš„ç®¡ç†æƒé™å—ï¼Ÿ"))&&ne.mutate({shopId:D.id,userId:e.userId})}(e)},className:"px-3 py-1 text-xs bg-red-600 hover:bg-red-500 text-white rounded",children:"ç§»é™¤"})]},e.id)})})]}),l.jsx("button",{onClick:function(){return B(!0)},className:"w-full px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white rounded-lg",children:"+ æ·»åŠ ç®¡ç†å‘˜"})]})}),E&&D&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 w-full max-w-md",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-bold text-white",children:"æ·»åŠ ç®¡ç†å‘˜"}),l.jsx("button",{onClick:function(){B(!1),W("")},className:"text-gray-400 hover:text-white",children:"âœ•"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"æœç´¢ç”¨æˆ·"}),l.jsx("input",{type:"text",value:G,onChange:function(e){return W(e.target.value)},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"è¾“å…¥é‚®ç®±æˆ–æ˜µç§°æœç´¢..."})]}),G.length>=2&&l.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:0===(null==te?void 0:te.users.length)?l.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"æœªæ‰¾åˆ°ç”¨æˆ·"}):null==te?void 0:te.users.map(function(e){var t,s=null==Y?void 0:Y.managers.some(function(t){return t.userId===e.id});return l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-700 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[e.avatar?l.jsx("img",{src:g(e.avatar),alt:"",className:"w-8 h-8 rounded-full object-cover"}):l.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center text-gray-400",children:(null===(t=e.email||e.phone)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.toUpperCase())||"?"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-white text-sm",children:e.cnName||"æœªè®¾ç½®"}),l.jsx("p",{className:"text-gray-400 text-xs",children:e.email||e.phone})]})]}),s?l.jsx("span",{className:"text-gray-500 text-xs",children:"å·²æ·»åŠ "}):l.jsx("button",{onClick:function(){return function(e){D&&re.mutate({shopId:D.id,userId:e.id,role:"manager"})}(e)},className:"px-3 py-1 text-xs bg-purple-600 hover:bg-purple-500 text-white rounded",children:"æ·»åŠ "})]},e.id)})})]})})]})}var q=[{value:"bug",label:"BugæŠ¥å‘Š",color:"bg-red-500"},{value:"feature",label:"åŠŸèƒ½å»ºè®®",color:"bg-blue-500"},{value:"question",label:"é—®é¢˜å’¨è¯¢",color:"bg-yellow-500"},{value:"other",label:"å…¶ä»–",color:"bg-gray-500"}],A=[{value:"pending",label:"å¾…å¤„ç†",color:"bg-yellow-500"},{value:"processing",label:"å¤„ç†ä¸­",color:"bg-blue-500"},{value:"resolved",label:"å·²è§£å†³",color:"bg-green-500"},{value:"closed",label:"å·²å…³é—­",color:"bg-gray-500"}];function F(){var e,t,s=o(),r=d(f.useState(1),2),u=r[0],m=r[1],h=d(f.useState(""),2),g=h[0],b=h[1],y=d(f.useState(""),2),j=y[0],v=y[1],N=d(f.useState(null),2),w=N[0],C=N[1],S=i({queryKey:["admin-feedbacks",u,g,j],queryFn:(e=c(a().m(function e(){var t,s;return a().w(function(e){for(;;)switch(e.n){case 0:return t=new URLSearchParams({page:u.toString(),limit:"20"}),g&&t.append("status",g),j&&t.append("type",j),e.n=1,p.get("/admin/feedbacks?".concat(t));case 1:return s=e.v,e.a(2,s.data)}},e)})),function(){return e.apply(this,arguments)})}),P=S.data,I=S.isLoading,F=x({mutationFn:(t=c(a().m(function e(t){var s,r;return a().w(function(e){for(;;)switch(e.n){case 0:return s=t.feedbackId,r=t.status,e.n=1,p.put("/admin/feedbacks/".concat(s,"/status"),{status:r});case 1:return e.a(2)}},e)})),function(e){return t.apply(this,arguments)}),onSuccess:function(){s.invalidateQueries({queryKey:["admin-feedbacks"]}),C(null)}}),L=function(e){return q.find(function(t){return t.value===e})||q[3]},U=function(e){return A.find(function(t){return t.value===e})||A[0]};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"åé¦ˆç®¡ç†"}),l.jsx("p",{className:"text-gray-400 mt-1",children:"å¤„ç†ç”¨æˆ·åé¦ˆå’Œé—®é¢˜"})]}),l.jsx("div",{className:"bg-gray-800 rounded-xl p-4 border border-gray-700",children:l.jsxs("div",{className:"flex flex-wrap gap-4",children:[l.jsx(k,{value:g,onChange:function(e){b(e),m(1)},options:[{value:"",label:"å…¨éƒ¨çŠ¶æ€"}].concat(n(A.map(function(e){return{value:e.value,label:e.label}}))),className:"w-40"}),l.jsx(k,{value:j,onChange:function(e){v(e),m(1)},options:[{value:"",label:"å…¨éƒ¨ç±»å‹"}].concat(n(q.map(function(e){return{value:e.value,label:e.label}}))),className:"w-40"})]})}),l.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:I?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"divide-y divide-gray-700",children:[null==P?void 0:P.feedbacks.map(function(e){return l.jsx("div",{className:"p-4 hover:bg-gray-700/30 cursor-pointer",onClick:function(){return C(e)},children:l.jsxs("div",{className:"flex items-start justify-between gap-4",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs rounded-full text-white ".concat(L(e.type).color),children:L(e.type).label}),l.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs rounded-full text-white ".concat(U(e.status).color),children:U(e.status).label})]}),l.jsx("h3",{className:"text-white font-medium truncate",children:e.title}),l.jsx("p",{className:"text-gray-400 text-sm mt-1 line-clamp-2",children:e.content})]}),l.jsx("div",{className:"text-right text-sm text-gray-400 whitespace-nowrap",children:new Date(e.createdAt).toLocaleDateString("zh-CN")})]})},e.id)}),0===(null==P?void 0:P.feedbacks.length)&&l.jsx("div",{className:"p-8 text-center text-gray-400",children:"æš‚æ— åé¦ˆ"})]}),P&&P.totalPages>1&&l.jsxs("div",{className:"px-4 py-3 border-t border-gray-700 flex items-center justify-between",children:[l.jsxs("p",{className:"text-sm text-gray-400",children:["å…± ",P.total," æ¡è®°å½•ï¼Œç¬¬ ",P.page," / ",P.totalPages," é¡µ"]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:function(){return m(function(e){return Math.max(1,e-1)})},disabled:1===u,className:"px-3 py-1 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"ä¸Šä¸€é¡µ"}),l.jsx("button",{onClick:function(){return m(function(e){return Math.min(P.totalPages,e+1)})},disabled:u===P.totalPages,className:"px-3 py-1 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"ä¸‹ä¸€é¡µ"})]})]})]})}),w&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 w-full max-w-2xl border border-gray-700 max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs rounded-full text-white ".concat(L(w.type).color),children:L(w.type).label}),l.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs rounded-full text-white ".concat(U(w.status).color),children:U(w.status).label})]}),l.jsx("button",{onClick:function(){return C(null)},className:"text-gray-400 hover:text-white",children:"âœ•"})]}),l.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:w.title}),l.jsxs("div",{className:"text-sm text-gray-400 mb-4",children:["æäº¤æ—¶é—´ï¼š",new Date(w.createdAt).toLocaleString("zh-CN"),w.contact&&l.jsxs("span",{className:"ml-4",children:["è”ç³»æ–¹å¼ï¼š",w.contact]})]}),l.jsx("div",{className:"bg-gray-700/50 rounded-lg p-4 mb-6",children:l.jsx("p",{className:"text-gray-300 whitespace-pre-wrap",children:w.content})}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("label",{className:"block text-sm text-gray-400",children:"æ›´æ–°çŠ¶æ€"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:A.map(function(e){return l.jsx("button",{onClick:function(){return F.mutate({feedbackId:w.id,status:e.value})},disabled:F.isPending,className:"px-4 py-2 rounded-lg text-sm transition-colors ".concat(w.status===e.value?"".concat(e.color," text-white"):"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:e.label},e.value)})})]})]})})]})}var L={info:"bg-blue-500/20 text-blue-400",warning:"bg-yellow-500/20 text-yellow-400",error:"bg-red-500/20 text-red-400",critical:"bg-red-600/30 text-red-300"};function U(){var e,t,r,n,u,m,h,g,b,y,j,v,N,w=o(),k=d(f.useState("logs"),2),C=k[0],S=k[1],P=d(f.useState(1),2),I=P[0],q=P[1],A=d(f.useState(!1),2),F=A[0],U=A[1],K=d(f.useState({ip:"",reason:"",duration:""}),2),O=K[0],T=K[1],D=i({queryKey:["admin-security-logs",I],queryFn:(h=c(a().m(function e(){var t;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.get("/admin/security/logs?page=".concat(I,"&limit=50"));case 1:return t=e.v,e.a(2,t.data)}},e)})),function(){return h.apply(this,arguments)}),enabled:"logs"===C}),z=i({queryKey:["admin-blocked-ips",I],queryFn:(g=c(a().m(function e(){var t;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.get("/admin/security/blocked-ips?page=".concat(I,"&limit=50"));case 1:return t=e.v,e.a(2,t.data)}},e)})),function(){return g.apply(this,arguments)}),enabled:"blocked-ips"===C}),M=i({queryKey:["admin-login-attempts",I],queryFn:(b=c(a().m(function e(){var t;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.get("/admin/security/login-attempts?page=".concat(I,"&limit=50"));case 1:return t=e.v,e.a(2,t.data)}},e)})),function(){return b.apply(this,arguments)}),enabled:"login-attempts"===C}),R=i({queryKey:["admin-firewall-bans"],queryFn:(y=c(a().m(function e(){var t;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.get("/admin/security/firewall-bans");case 1:return t=e.v,e.a(2,t.data)}},e)})),function(){return y.apply(this,arguments)}),enabled:"firewall-bans"===C,refetchInterval:3e4}),Q=x({mutationFn:(j=c(a().m(function e(t){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.delete("/admin/security/blocked-ips/".concat(t));case 1:return e.a(2)}},e)})),function(e){return j.apply(this,arguments)}),onSuccess:function(){w.invalidateQueries({queryKey:["admin-blocked-ips"]})}}),_=x({mutationFn:(v=c(a().m(function e(t){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.post("/admin/security/blocked-ips",t);case 1:return e.a(2)}},e)})),function(e){return v.apply(this,arguments)}),onSuccess:function(){w.invalidateQueries({queryKey:["admin-blocked-ips"]}),U(!1),T({ip:"",reason:"",duration:""})}}),E=x({mutationFn:(N=c(a().m(function e(t){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.post("/admin/security/unban-firewall",{ip:t});case 1:return e.a(2)}},e)})),function(e){return N.apply(this,arguments)}),onSuccess:function(){w.invalidateQueries({queryKey:["admin-firewall-bans"]}),w.invalidateQueries({queryKey:["admin-blocked-ips"]})}});return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"å®‰å…¨ç®¡ç†"}),l.jsx("p",{className:"text-gray-400 mt-1",children:"ç›‘æ§ç³»ç»Ÿå®‰å…¨çŠ¶æ€"})]}),l.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700",children:[l.jsx("div",{className:"flex border-b border-gray-700",children:[{id:"logs",label:"å®‰å…¨æ—¥å¿—",icon:"ğŸ“‹"},{id:"blocked-ips",label:"æ•°æ®åº“å°ç¦",icon:"ğŸš«"},{id:"firewall-bans",label:"é˜²ç«å¢™å°ç¦",icon:"ğŸ”¥"},{id:"login-attempts",label:"ç™»å½•è®°å½•",icon:"ğŸ”"}].map(function(e){return l.jsxs("button",{onClick:function(){S(e.id),q(1)},className:"flex items-center gap-2 px-6 py-3 text-sm font-medium transition-colors ".concat(C===e.id?"text-purple-400 border-b-2 border-purple-400":"text-gray-400 hover:text-white"),children:[l.jsx("span",{children:e.icon}),l.jsx("span",{children:e.label})]},e.id)})}),l.jsxs("div",{className:"p-4",children:["logs"===C&&l.jsx("div",{className:"space-y-4",children:D.isLoading?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"space-y-2",children:null===(e=D.data)||void 0===e?void 0:e.logs.map(function(e){return l.jsx("div",{className:"bg-gray-700/50 rounded-lg p-3",children:l.jsxs("div",{className:"flex items-start justify-between gap-4",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs rounded-full ".concat(L[e.severity]||L.info),children:e.severity}),l.jsx("span",{className:"text-xs text-gray-400",children:e.type})]}),l.jsx("p",{className:"text-gray-300 text-sm",children:e.message}),l.jsxs("div",{className:"flex gap-4 mt-1 text-xs text-gray-500",children:[e.ip&&l.jsxs("span",{children:["IP: ",e.ip]}),e.email&&l.jsxs("span",{children:["Email: ",e.email]})]})]}),l.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:new Date(e.createdAt).toLocaleString("zh-CN")})]})},e.id)})}),D.data&&D.data.totalPages>1&&l.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-700",children:[l.jsxs("p",{className:"text-sm text-gray-400",children:["å…± ",D.data.total," æ¡è®°å½•"]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:function(){return q(function(e){return Math.max(1,e-1)})},disabled:1===I,className:"px-3 py-1 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 disabled:opacity-50",children:"ä¸Šä¸€é¡µ"}),l.jsx("button",{onClick:function(){return q(function(e){return e+1})},disabled:I>=D.data.totalPages,className:"px-3 py-1 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 disabled:opacity-50",children:"ä¸‹ä¸€é¡µ"})]})]})]})}),"blocked-ips"===C&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("p",{className:"text-sm text-gray-400",children:"æ•°æ®åº“ä¸­çš„å°ç¦è®°å½•ï¼ˆæŒä¹…åŒ–å­˜å‚¨ï¼‰"}),l.jsx("button",{onClick:function(){return U(!0)},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"+ å°ç¦IP"})]}),z.isLoading?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-700/50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"IPåœ°å€"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"åŸå› "}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"è¿‡æœŸæ—¶é—´"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"çŠ¶æ€"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"æ“ä½œ"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-700",children:null===(t=z.data)||void 0===t?void 0:t.blockedIPs.map(function(e){return l.jsxs("tr",{className:"hover:bg-gray-700/30",children:[l.jsx("td",{className:"px-4 py-3 text-white font-mono",children:e.ip}),l.jsx("td",{className:"px-4 py-3 text-gray-300",children:e.reason}),l.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:e.expiresAt?new Date(e.expiresAt).toLocaleString("zh-CN"):"æ°¸ä¹…"}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs rounded-full ".concat(e.unblocked?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:e.unblocked?"å·²è§£å°":"å°ç¦ä¸­"})}),l.jsx("td",{className:"px-4 py-3",children:!e.unblocked&&l.jsx("button",{onClick:function(){return Q.mutate(e.id)},className:"text-green-400 hover:text-green-300 text-sm",children:"è§£å°"})})]},e.id)})})]})}),z.data&&z.data.totalPages>1&&l.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-700",children:[l.jsxs("p",{className:"text-sm text-gray-400",children:["å…± ",z.data.total," æ¡è®°å½•"]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:function(){return q(function(e){return Math.max(1,e-1)})},disabled:1===I,className:"px-3 py-1 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 disabled:opacity-50",children:"ä¸Šä¸€é¡µ"}),l.jsx("button",{onClick:function(){return q(function(e){return e+1})},disabled:I>=z.data.totalPages,className:"px-3 py-1 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 disabled:opacity-50",children:"ä¸‹ä¸€é¡µ"})]})]})]})]}),"firewall-bans"===C&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("p",{className:"text-sm text-gray-400",children:"é˜²ç«å¢™å†…å­˜ä¸­çš„å®æ—¶å°ç¦ï¼ˆæœåŠ¡é‡å¯åæ¸…ç©ºï¼Œå·²åŒæ­¥åˆ°æ•°æ®åº“ï¼‰"}),l.jsx("button",{onClick:function(){return R.refetch()},className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"ğŸ”„ åˆ·æ–°"})]}),R.isLoading?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):0===(null===(r=R.data)||void 0===r?void 0:r.bannedIPs.length)?l.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400",children:[l.jsx("span",{className:"text-4xl mb-4",children:"âœ…"}),l.jsx("p",{children:"å½“å‰æ²¡æœ‰è¢«é˜²ç«å¢™å°ç¦çš„IP"})]}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-700/50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"IPåœ°å€"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"å°ç¦åŸå› "}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"å°ç¦æ—¶é—´"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"è¿‡æœŸæ—¶é—´"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"æ“ä½œ"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-700",children:null===(n=R.data)||void 0===n?void 0:n.bannedIPs.map(function(e){return l.jsxs("tr",{className:"hover:bg-gray-700/30",children:[l.jsx("td",{className:"px-4 py-3 text-white font-mono",children:e.ip}),l.jsx("td",{className:"px-4 py-3 text-gray-300",children:e.reason||"æœªçŸ¥"}),l.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(e.bannedAt).toLocaleString("zh-CN")}),l.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(e.expiresAt).toLocaleString("zh-CN")}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("button",{onClick:function(){return E.mutate(e.ip)},disabled:E.isPending,className:"text-green-400 hover:text-green-300 text-sm disabled:opacity-50",children:E.isPending?"è§£å°ä¸­...":"è§£å°"})})]},e.ip)})})]})}),l.jsx("div",{className:"pt-4 border-t border-gray-700",children:l.jsxs("p",{className:"text-sm text-gray-400",children:["å…± ",(null===(u=R.data)||void 0===u?void 0:u.total)||0," æ¡è®°å½• Â· æ¯30ç§’è‡ªåŠ¨åˆ·æ–°"]})})]}),"login-attempts"===C&&l.jsx("div",{className:"space-y-4",children:M.isLoading?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-700/50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"é‚®ç®±"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"æ‰‹æœºå·"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"çŠ¶æ€"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"IP"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"æ—¶é—´"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-700",children:null===(m=M.data)||void 0===m?void 0:m.attempts.map(function(e){return l.jsxs("tr",{className:"hover:bg-gray-700/30",children:[l.jsx("td",{className:"px-4 py-3 text-white",children:e.email||"-"}),l.jsx("td",{className:"px-4 py-3 text-white",children:e.phone||"-"}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs rounded-full ".concat(e.success?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:e.success?"æˆåŠŸ":"å¤±è´¥"})}),l.jsx("td",{className:"px-4 py-3 text-gray-400 font-mono text-sm",children:e.ip||"-"}),l.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(e.createdAt).toLocaleString("zh-CN")})]},e.id)})})]})}),M.data&&M.data.totalPages>1&&l.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-700",children:[l.jsxs("p",{className:"text-sm text-gray-400",children:["å…± ",M.data.total," æ¡è®°å½•"]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:function(){return q(function(e){return Math.max(1,e-1)})},disabled:1===I,className:"px-3 py-1 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 disabled:opacity-50",children:"ä¸Šä¸€é¡µ"}),l.jsx("button",{onClick:function(){return q(function(e){return e+1})},disabled:I>=M.data.totalPages,className:"px-3 py-1 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 disabled:opacity-50",children:"ä¸‹ä¸€é¡µ"})]})]})]})})]})]}),F&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 w-full max-w-md border border-gray-700",children:[l.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"å°ç¦IP"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"IPåœ°å€"}),l.jsx("input",{type:"text",value:O.ip,onChange:function(e){return T(function(t){return s(s({},t),{},{ip:e.target.value})})},placeholder:"192.168.1.1",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-purple-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"å°ç¦åŸå› "}),l.jsx("input",{type:"text",value:O.reason,onChange:function(e){return T(function(t){return s(s({},t),{},{reason:e.target.value})})},placeholder:"æ¶æ„è¯·æ±‚",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-purple-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"å°ç¦æ—¶é•¿ï¼ˆå°æ—¶ï¼Œç•™ç©ºä¸ºæ°¸ä¹…ï¼‰"}),l.jsx("input",{type:"number",value:O.duration,onChange:function(e){return T(function(t){return s(s({},t),{},{duration:e.target.value})})},placeholder:"24",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-purple-500"})]}),l.jsxs("div",{className:"flex gap-3 pt-4",children:[l.jsx("button",{onClick:function(){return U(!1)},className:"flex-1 px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:function(){var e;if(O.duration){var t=parseInt(O.duration);isNaN(t)||(e=new Date(Date.now()+60*t*60*1e3).toISOString())}_.mutate({ip:O.ip,reason:O.reason,expiresAt:e})},disabled:!O.ip||!O.reason||_.isPending,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:_.isPending?"å°ç¦ä¸­...":"ç¡®è®¤å°ç¦"})]})]})]})})]})}function K(){var e,t,r,u=o(),m=d(f.useState(1),2),h=m[0],g=m[1],b=d(f.useState(!1),2),y=b[0],j=b[1],v=d(f.useState({title:"",content:"",type:"system",targetType:"all",targetRoles:[],targetUserIds:"",expiresInDays:""}),2),N=v[0],w=v[1],C=i({queryKey:["admin-notifications",h],queryFn:(e=c(a().m(function e(){var t;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.get("/admin/notifications?page=".concat(h,"&limit=20"));case 1:return t=e.v,e.a(2,t.data)}},e)})),function(){return e.apply(this,arguments)})}),S=C.data,P=C.isLoading,I=x({mutationFn:(t=c(a().m(function e(t){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.post("/admin/notifications",t);case 1:return e.a(2)}},e)})),function(e){return t.apply(this,arguments)}),onSuccess:function(){u.invalidateQueries({queryKey:["admin-notifications"]}),j(!1),w({title:"",content:"",type:"system",targetType:"all",targetRoles:[],targetUserIds:"",expiresInDays:""})}}),q=x({mutationFn:(r=c(a().m(function e(t){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.delete("/admin/notifications/".concat(t));case 1:return e.a(2)}},e)})),function(e){return r.apply(this,arguments)}),onSuccess:function(){u.invalidateQueries({queryKey:["admin-notifications"]})}}),A={system:"ç³»ç»Ÿé€šçŸ¥",announcement:"å…¬å‘Š",update:"æ›´æ–°",warning:"è­¦å‘Š"},F={all:"å…¨éƒ¨ç”¨æˆ·",role:"æŒ‡å®šè§’è‰²",user:"æŒ‡å®šç”¨æˆ·"};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"é€šçŸ¥ç®¡ç†"}),l.jsx("p",{className:"text-gray-400 mt-1",children:"å‘é€å’Œç®¡ç†ç³»ç»Ÿé€šçŸ¥"})]}),l.jsxs("button",{onClick:function(){return j(!0)},className:"px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white rounded-lg flex items-center gap-2",children:[l.jsx("span",{children:"+"}),l.jsx("span",{children:"å‘é€é€šçŸ¥"})]})]}),l.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-900",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"æ ‡é¢˜"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"ç±»å‹"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"ç›®æ ‡"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"åˆ›å»ºæ—¶é—´"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"è¿‡æœŸæ—¶é—´"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-400",children:"æ“ä½œ"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-700",children:P?l.jsx("tr",{children:l.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:"åŠ è½½ä¸­..."})}):0===(null==S?void 0:S.notifications.length)?l.jsx("tr",{children:l.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:"æš‚æ— é€šçŸ¥"})}):null==S?void 0:S.notifications.map(function(e){return l.jsxs("tr",{className:"hover:bg-gray-700/50",children:[l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{children:[l.jsx("p",{className:"text-white font-medium",children:e.title}),l.jsx("p",{className:"text-gray-400 text-sm truncate max-w-xs",children:e.content})]})}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-blue-600 text-white",children:A[e.type]||e.type})}),l.jsxs("td",{className:"px-4 py-3 text-gray-400 text-sm",children:[F[e.targetType]||e.targetType,e.targetRoles&&e.targetRoles.length>0&&l.jsxs("span",{className:"ml-1",children:["(",e.targetRoles.join(", "),")"]})]}),l.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(e.createdAt).toLocaleString()}),l.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:e.expiresAt?new Date(e.expiresAt).toLocaleString():"æ°¸ä¸è¿‡æœŸ"}),l.jsx("td",{className:"px-4 py-3 text-right",children:l.jsx("button",{onClick:function(){confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡é€šçŸ¥å—ï¼Ÿ")&&q.mutate(e.id)},className:"px-3 py-1 text-xs bg-red-600 hover:bg-red-500 text-white rounded",children:"åˆ é™¤"})})]},e.id)})})]})}),S&&S.totalPages>1&&l.jsxs("div",{className:"flex justify-center gap-2",children:[l.jsx("button",{onClick:function(){return g(function(e){return Math.max(1,e-1)})},disabled:1===h,className:"px-4 py-2 bg-gray-700 text-white rounded disabled:opacity-50",children:"ä¸Šä¸€é¡µ"}),l.jsxs("span",{className:"px-4 py-2 text-gray-400",children:[h," / ",S.totalPages]}),l.jsx("button",{onClick:function(){return g(function(e){return Math.min(S.totalPages,e+1)})},disabled:h===S.totalPages,className:"px-4 py-2 bg-gray-700 text-white rounded disabled:opacity-50",children:"ä¸‹ä¸€é¡µ"})]}),y&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[l.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"å‘é€é€šçŸ¥"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"æ ‡é¢˜"}),l.jsx("input",{type:"text",value:N.title,onChange:function(e){return w(s(s({},N),{},{title:e.target.value}))},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"é€šçŸ¥æ ‡é¢˜"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"å†…å®¹"}),l.jsx("textarea",{value:N.content,onChange:function(e){return w(s(s({},N),{},{content:e.target.value}))},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",rows:4,placeholder:"é€šçŸ¥å†…å®¹..."})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"ç±»å‹"}),l.jsx(k,{value:N.type,onChange:function(e){return w(s(s({},N),{},{type:e}))},options:[{value:"system",label:"ç³»ç»Ÿé€šçŸ¥"},{value:"announcement",label:"å…¬å‘Š"},{value:"update",label:"æ›´æ–°"},{value:"warning",label:"è­¦å‘Š"}]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"ç›®æ ‡ç”¨æˆ·"}),l.jsx(k,{value:N.targetType,onChange:function(e){return w(s(s({},N),{},{targetType:e}))},options:[{value:"all",label:"å…¨éƒ¨ç”¨æˆ·"},{value:"role",label:"æŒ‡å®šè§’è‰²"},{value:"user",label:"æŒ‡å®šç”¨æˆ·"}]})]})]}),"role"===N.targetType&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"é€‰æ‹©è§’è‰²"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"user",label:"æ™®é€šç”¨æˆ·"},{value:"shop_owner",label:"å·¥åŠç®¡ç†å‘˜"},{value:"reviewer",label:"å®¡æ ¸å‘˜"},{value:"ops",label:"è¿ç»´"},{value:"admin",label:"ç®¡ç†å‘˜"}].map(function(e){return l.jsxs("label",{className:"flex items-center gap-2 text-gray-300",children:[l.jsx("input",{type:"checkbox",checked:N.targetRoles.includes(e.value),onChange:function(t){t.target.checked?w(s(s({},N),{},{targetRoles:[].concat(n(N.targetRoles),[e.value])})):w(s(s({},N),{},{targetRoles:N.targetRoles.filter(function(t){return t!==e.value})}))},className:"w-4 h-4 rounded bg-gray-700 border-gray-600"}),e.label]},e.value)})})]}),"user"===N.targetType&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"ç”¨æˆ·IDï¼ˆé€—å·åˆ†éš”ï¼‰"}),l.jsx("input",{type:"text",value:N.targetUserIds,onChange:function(e){return w(s(s({},N),{},{targetUserIds:e.target.value}))},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"user_id_1, user_id_2, ..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"æœ‰æ•ˆæœŸï¼ˆå¤©ï¼Œç•™ç©ºä¸ºæ°¸ä¹…ï¼‰"}),l.jsx("input",{type:"number",value:N.expiresInDays,onChange:function(e){return w(s(s({},N),{},{expiresInDays:e.target.value}))},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"å¤©æ•°",min:1})]})]}),l.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[l.jsx("button",{onClick:function(){return j(!1)},className:"px-4 py-2 bg-gray-700 text-white rounded-lg",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:function(){var e={title:N.title,content:N.content,type:N.type,targetType:N.targetType};"role"===N.targetType&&N.targetRoles.length>0&&(e.targetRoles=N.targetRoles),"user"===N.targetType&&N.targetUserIds&&(e.targetUserIds=N.targetUserIds.split(",").map(function(e){return e.trim()}).filter(Boolean)),N.expiresInDays&&(e.expiresAt=new Date(Date.now()+24*Number(N.expiresInDays)*60*60*1e3).toISOString()),I.mutate(e)},disabled:!N.title||!N.content,className:"px-4 py-2 bg-purple-600 text-white rounded-lg disabled:opacity-50",children:"å‘é€"})]})]})})]})}var O={profile:"ç”¨æˆ·èµ„æ–™",shop:"å·¥åŠ",kigurumi:"å¤´å£³",product:"äº§å“",album:"ç›¸å†Œ"},T={pending:"bg-yellow-500/20 text-yellow-400",approved:"bg-green-500/20 text-green-400",rejected:"bg-red-500/20 text-red-400",hidden:"bg-gray-500/20 text-gray-400"},D={pending:"å¾…å®¡æ ¸",approved:"å·²é€šè¿‡",rejected:"å·²ä¸‹æ¶",hidden:"å·²ä¸‹æ¶"};function z(){var e=d(f.useState(null),2),t=e[0],s=e[1];return t?l.jsx(R,{user:t,onBack:function(){return s(null)}}):l.jsx(M,{onSelectUser:s})}function M(e){var t,s,r=e.onSelectUser,n=o(),u=h({position:"center"}),m=u.showNotification,g=u.NotificationComponent,b=d(f.useState(1),2),y=b[0],j=b[1],v=d(f.useState(""),2),N=v[0],w=v[1],k=d(f.useState("pending"),2),C=k[0],S=k[1],P=i({queryKey:["admin-images-stats"],queryFn:(t=c(a().m(function e(){var t;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.get("/admin/images/stats");case 1:return t=e.v,e.a(2,t.data.stats)}},e)})),function(){return t.apply(this,arguments)})}),I=P.data,q=i({queryKey:["admin-image-users",y,N,C],queryFn:(s=c(a().m(function e(){var t,s;return a().w(function(e){for(;;)switch(e.n){case 0:return t=new URLSearchParams({page:y.toString(),limit:"20"}),N&&t.append("search",N),C&&t.append("filter",C),e.n=1,p.get("/admin/images/users?".concat(t));case 1:return s=e.v,e.a(2,s.data)}},e)})),function(){return s.apply(this,arguments)})}),A=q.data,F=q.isLoading,L=x({mutationFn:function(){return p.post("/admin/images/sync")},onSuccess:function(){n.invalidateQueries({queryKey:["admin-image-users"]}),n.invalidateQueries({queryKey:["admin-images-stats"]}),m("å›¾ç‰‡åŒæ­¥å®Œæˆ","success")}}),U=I,K=(null==A?void 0:A.users)||[];return l.jsxs("div",{className:"space-y-6",children:[g,l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"å›¾ç‰‡å®¡æ ¸"}),l.jsx("p",{className:"text-gray-400 mt-1",children:"æŒ‰ç”¨æˆ·æŸ¥çœ‹å’Œå®¡æ ¸ä¸Šä¼ çš„å›¾ç‰‡"})]}),l.jsx("button",{onClick:function(){return L.mutate()},disabled:L.isPending,className:"px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white rounded-lg disabled:opacity-50 text-sm",children:L.isPending?"åŒæ­¥ä¸­...":"åŒæ­¥å›¾ç‰‡"})]}),U&&l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4",children:[l.jsx("p",{className:"text-yellow-400 text-sm",children:"å¾…å®¡æ ¸"}),l.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:U.pending})]}),l.jsxs("div",{className:"bg-green-500/10 border border-green-500/20 rounded-xl p-4",children:[l.jsx("p",{className:"text-green-400 text-sm",children:"å·²é€šè¿‡"}),l.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:U.approved})]}),l.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-4",children:[l.jsx("p",{className:"text-red-400 text-sm",children:"å·²ä¸‹æ¶"}),l.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:U.rejected+U.hidden})]}),l.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/20 rounded-xl p-4",children:[l.jsx("p",{className:"text-purple-400 text-sm",children:"æ€»è®¡"}),l.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:U.pending+U.approved+U.rejected+U.hidden})]})]}),l.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[l.jsx("input",{type:"text",placeholder:"æœç´¢ç”¨æˆ·å/é‚®ç®±...",value:N,onChange:function(e){w(e.target.value),j(1)},className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 text-sm"}),l.jsx("div",{className:"flex gap-2",children:[{value:"pending",label:"æœ‰å¾…å®¡æ ¸"},{value:"",label:"å…¨éƒ¨ç”¨æˆ·"}].map(function(e){return l.jsx("button",{onClick:function(){S(e.value),j(1)},className:"px-3 py-2 rounded-lg text-sm transition ".concat(C===e.value?"bg-purple-500 text-white":"bg-white/5 text-white/60 hover:bg-white/10"),children:e.label},e.value)})})]}),F?l.jsx("div",{className:"flex justify-center py-16",children:l.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-purple-500"})}):0===K.length?l.jsx("div",{className:"text-center py-16 text-gray-500",children:"æš‚æ— æ•°æ®"}):l.jsx("div",{className:"space-y-3",children:K.map(function(e){return l.jsxs("div",{onClick:function(){return r(e)},className:"bg-gray-800/50 border border-gray-700 rounded-xl p-4 hover:bg-gray-800 cursor-pointer transition flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400 font-bold",children:(e.ownerName||"?")[0]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-white font-medium",children:e.ownerName||"æœªçŸ¥ç”¨æˆ·"}),l.jsx("p",{className:"text-gray-500 text-xs",children:e.ownerEmail||e.ownerId})]})]}),l.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.pending>0&&l.jsxs("span",{className:"px-2.5 py-1 bg-yellow-500/20 text-yellow-400 rounded-lg font-medium",children:[e.pending," å¾…å®¡æ ¸"]}),l.jsxs("span",{className:"text-green-400",children:[e.approved," é€šè¿‡"]}),e.removed>0&&l.jsxs("span",{className:"text-red-400",children:[e.removed," ä¸‹æ¶"]}),l.jsxs("span",{className:"text-gray-500",children:["å…± ",e.total," å¼ "]}),l.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},e.ownerId)})}),A&&A.totalPages>1&&l.jsxs("div",{className:"flex justify-center gap-2",children:[l.jsx("button",{onClick:function(){return j(function(e){return Math.max(1,e-1)})},disabled:y<=1,className:"px-3 py-1.5 bg-white/5 rounded-lg text-sm disabled:opacity-30",children:"ä¸Šä¸€é¡µ"}),l.jsxs("span",{className:"px-3 py-1.5 text-sm text-white/60",children:[y," / ",A.totalPages]}),l.jsx("button",{onClick:function(){return j(function(e){return Math.min(A.totalPages,e+1)})},disabled:y>=A.totalPages,className:"px-3 py-1.5 bg-white/5 rounded-lg text-sm disabled:opacity-30",children:"ä¸‹ä¸€é¡µ"})]})]})}function R(e){var t,r,u,m=e.user,b=e.onBack,y=o(),j=h({position:"center"}),v=j.showNotification,N=j.NotificationComponent,w=d(f.useState([]),2),k=w[0],C=w[1],S=d(f.useState(""),2),P=S[0],I=S[1],q=d(f.useState(null),2),A=q[0],F=q[1],L=d(f.useState(null),2),U=L[0],K=L[1],z=d(f.useState(""),2),M=z[0],R=z[1],Q=d(f.useState(!0),2),_=Q[0],E=Q[1],B=i({queryKey:["admin-user-images",m.ownerId,P],queryFn:(t=c(a().m(function e(){var t,s;return a().w(function(e){for(;;)switch(e.n){case 0:return t=new URLSearchParams,P&&t.append("status",P),e.n=1,p.get("/admin/images/users/".concat(m.ownerId,"?").concat(t));case 1:return s=e.v,e.a(2,s.data)}},e)})),function(){return t.apply(this,arguments)})}),V=B.data,G=B.isLoading,W=(null==V?void 0:V.images)||[],$=""===P?{total:W.length,pending:W.filter(function(e){return"pending"===e.status}).length,approved:W.filter(function(e){return"approved"===e.status}).length,removed:W.filter(function(e){return"rejected"===e.status||"hidden"===e.status}).length}:null,H=$?s(s({},m),$):m,J=x({mutationFn:(r=c(a().m(function e(t){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.post("/admin/images/users/".concat(H.ownerId,"/approve"),{imageIds:t.length>0?t:void 0,notify:_});case 1:return e.a(2)}},e)})),function(e){return r.apply(this,arguments)}),onSuccess:function(e,t){var s=t.length||H.pending;v("å·²é€šè¿‡ ".concat(s," å¼ å›¾ç‰‡"),"success"),y.invalidateQueries({queryKey:["admin-user-images"]}),y.invalidateQueries({queryKey:["admin-image-users"]}),y.invalidateQueries({queryKey:["admin-images-stats"]}),C([]),K(null)},onError:function(){return v("æ“ä½œå¤±è´¥","error")}}),X=x({mutationFn:(u=c(a().m(function e(t){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.post("/admin/images/users/".concat(H.ownerId,"/remove"),{imageIds:t.length>0?t:void 0,reason:M||void 0,notify:_});case 1:return e.a(2)}},e)})),function(e){return u.apply(this,arguments)}),onSuccess:function(e,t){var s=t.length||W.length;v("å·²ä¸‹æ¶ ".concat(s," å¼ å›¾ç‰‡"),"success"),y.invalidateQueries({queryKey:["admin-user-images"]}),y.invalidateQueries({queryKey:["admin-image-users"]}),y.invalidateQueries({queryKey:["admin-images-stats"]}),C([]),K(null),R("")},onError:function(){return v("æ“ä½œå¤±è´¥","error")}}),Y=J.isPending||X.isPending;return l.jsxs("div",{className:"space-y-6",children:[N,l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:b,className:"w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 flex items-center justify-center transition",children:l.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),l.jsxs("div",{children:[l.jsxs("h1",{className:"text-xl font-bold text-white",children:[H.ownerName||"æœªçŸ¥ç”¨æˆ·"," çš„å›¾ç‰‡"]}),l.jsx("p",{className:"text-gray-400 text-sm",children:H.ownerEmail||H.ownerId})]})]}),l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex gap-3 text-sm",children:[l.jsxs("span",{className:"text-yellow-400",children:[H.pending," å¾…å®¡æ ¸"]}),l.jsxs("span",{className:"text-green-400",children:[H.approved," å·²é€šè¿‡"]}),H.removed>0&&l.jsxs("span",{className:"text-red-400",children:[H.removed," å·²ä¸‹æ¶"]}),l.jsxs("span",{className:"text-gray-500",children:["å…± ",H.total," å¼ "]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:function(){return K("approveAll")},disabled:Y||0===H.pending,className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg text-sm disabled:opacity-50 transition",children:"å…¨éƒ¨é€šè¿‡"}),l.jsx("button",{onClick:function(){return K("removeAll")},disabled:Y,className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg text-sm disabled:opacity-50 transition",children:"å…¨éƒ¨ä¸‹æ¶"})]})]}),l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[l.jsx("div",{className:"flex gap-2",children:[{value:"",label:"å…¨éƒ¨"},{value:"pending",label:"å¾…å®¡æ ¸"},{value:"approved",label:"å·²é€šè¿‡"}].map(function(e){return l.jsx("button",{onClick:function(){I(e.value),C([])},className:"px-3 py-1.5 rounded-lg text-sm transition ".concat(P===e.value?"bg-purple-500 text-white":"bg-white/5 text-white/60 hover:bg-white/10"),children:e.label},e.value)})}),k.length>0&&l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:function(){return K("approve")},disabled:Y,className:"px-3 py-1.5 bg-green-600 hover:bg-green-500 text-white rounded-lg text-xs disabled:opacity-50",children:["é€šè¿‡é€‰ä¸­ (",k.length,")"]}),l.jsxs("button",{onClick:function(){return K("remove")},disabled:Y,className:"px-3 py-1.5 bg-red-600 hover:bg-red-500 text-white rounded-lg text-xs disabled:opacity-50",children:["ä¸‹æ¶é€‰ä¸­ (",k.length,")"]})]})]}),G?l.jsx("div",{className:"flex justify-center py-16",children:l.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-purple-500"})}):0===W.length?l.jsx("div",{className:"text-center py-16 text-gray-500",children:"æš‚æ— å›¾ç‰‡"}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-400",children:[l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:k.length===W.length&&W.length>0,onChange:function(){k.length===W.length?C([]):C(W.map(function(e){return e.id}))},className:"w-4 h-4 rounded bg-gray-700 border-gray-600"}),"å…¨é€‰"]}),l.jsxs("span",{children:["å…± ",W.length," å¼ "]})]}),l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3",children:W.map(function(e){return l.jsxs("div",{className:"relative group rounded-xl overflow-hidden bg-gray-700 ".concat(k.includes(e.id)?"ring-2 ring-purple-500":""),children:[l.jsx("div",{className:"absolute top-2 left-2 z-10",children:l.jsx("input",{type:"checkbox",checked:k.includes(e.id),onChange:function(){return t=e.id,void C(function(e){return e.includes(t)?e.filter(function(e){return e!==t}):[].concat(n(e),[t])});var t},className:"w-5 h-5 rounded bg-gray-800/80 border-gray-600 cursor-pointer"})}),l.jsx("div",{className:"absolute top-2 right-2 z-10",children:l.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] ".concat(T[e.status]||T.pending),children:D[e.status]||e.status})}),l.jsx("div",{className:"aspect-square cursor-pointer",onClick:function(){return F(e.imageUrl)},children:l.jsx("img",{src:g(e.imageUrl),alt:"",className:"w-full h-full object-cover",loading:"lazy"})}),l.jsx("div",{className:"p-1.5 text-[10px] text-gray-400 truncate",children:O[e.sourceType]||e.sourceType}),l.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition flex items-center justify-center gap-2",children:["approved"!==e.status&&l.jsx("button",{onClick:function(){C([e.id]),K("approve")},className:"px-3 py-1.5 bg-green-600 hover:bg-green-500 text-white rounded text-xs",children:"é€šè¿‡"}),l.jsx("button",{onClick:function(){C([e.id]),K("remove")},className:"px-3 py-1.5 bg-red-600 hover:bg-red-500 text-white rounded text-xs",children:"ä¸‹æ¶"})]})]},e.id)})})]}),U&&l.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:function(){return!Y&&K(null)},children:l.jsxs("div",{className:"bg-[#1a1a24] rounded-2xl p-6 max-w-md w-full",onClick:function(e){return e.stopPropagation()},children:[l.jsx("h3",{className:"text-lg font-bold text-white mb-3",children:U.includes("approve")?"ç¡®è®¤é€šè¿‡":"ç¡®è®¤ä¸‹æ¶"}),l.jsxs("p",{className:"text-white/60 text-sm mb-4",children:["approveAll"===U&&"å°†é€šè¿‡è¯¥ç”¨æˆ·æ‰€æœ‰å¾…å®¡æ ¸å›¾ç‰‡ï¼ˆ".concat(H.pending," å¼ ï¼‰"),"removeAll"===U&&"å°†ä¸‹æ¶è¯¥ç”¨æˆ·æ‰€æœ‰å›¾ç‰‡ï¼Œå›¾ç‰‡å°†ä»æ•°æ®åº“å’Œ OSS ä¸­æ°¸ä¹…åˆ é™¤","approve"===U&&"å°†é€šè¿‡é€‰ä¸­çš„ ".concat(k.length," å¼ å›¾ç‰‡"),"remove"===U&&"å°†ä¸‹æ¶é€‰ä¸­çš„ ".concat(k.length," å¼ å›¾ç‰‡ï¼Œå›¾ç‰‡å°†ä»æ•°æ®åº“å’Œ OSS ä¸­æ°¸ä¹…åˆ é™¤")]}),U.includes("remove")&&l.jsx("textarea",{value:M,onChange:function(e){return R(e.target.value)},placeholder:"ä¸‹æ¶åŸå› ï¼ˆå¯é€‰ï¼Œå°†é€šçŸ¥ç”¨æˆ·ï¼‰",className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-sm text-white placeholder-white/30 mb-3 resize-none",rows:2}),l.jsxs("label",{className:"flex items-center gap-2 text-white/60 text-sm mb-4 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:_,onChange:function(e){return E(e.target.checked)},className:"w-4 h-4 rounded bg-gray-700 border-gray-600"}),"é€šçŸ¥ç”¨æˆ·"]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:function(){K(null),R("")},disabled:Y,className:"flex-1 py-2.5 bg-white/10 rounded-xl text-sm text-white disabled:opacity-50",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:function(){U&&("approve"===U?J.mutate(k):"remove"===U?X.mutate(k):"approveAll"===U?J.mutate([]):"removeAll"===U&&X.mutate([]))},disabled:Y,className:"flex-1 py-2.5 rounded-xl text-sm text-white font-medium disabled:opacity-50 ".concat(U.includes("remove")?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"),children:Y?"å¤„ç†ä¸­...":"ç¡®è®¤"})]})]})}),A&&l.jsxs("div",{className:"fixed inset-0 bg-black/95 z-50 flex items-center justify-center",onClick:function(){return F(null)},children:[l.jsx("button",{className:"absolute top-4 right-4 w-10 h-10 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center",onClick:function(){return F(null)},children:l.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),l.jsx("img",{src:g(A)||A,alt:"",className:"max-w-full max-h-full object-contain",onClick:function(e){return e.stopPropagation()}})]})]})}var Q={inappropriate:"ä¸å½“å†…å®¹",copyright:"ä¾µæƒå†…å®¹",spam:"åƒåœ¾ä¿¡æ¯",other:"å…¶ä»–"},_={pending:"å¾…å¤„ç†",approved:"å·²ç¡®è®¤è¿è§„",rejected:"å·²é©³å›"},E={pending:"bg-yellow-500/20 text-yellow-400",approved:"bg-red-500/20 text-red-400",rejected:"bg-green-500/20 text-green-400"};function B(){var e,t,s,r=o(),n=h({position:"center"}),u=n.showNotification,m=n.NotificationComponent,b=d(f.useState(1),2),y=b[0],j=b[1],v=d(f.useState(""),2),N=v[0],w=v[1],k=d(f.useState(null),2),C=k[0],S=k[1],P=d(f.useState("approved"),2),I=P[0],q=P[1],A=d(f.useState(""),2),F=A[0],L=A[1],U=d(f.useState(null),2),K=U[0],O=U[1],T=i({queryKey:["admin-reports",y,N],queryFn:(e=c(a().m(function e(){var t,s;return a().w(function(e){for(;;)switch(e.n){case 0:return t=new URLSearchParams({page:y.toString(),limit:"20"}),N&&t.append("status",N),e.n=1,p.get("/admin/reports?".concat(t));case 1:return s=e.v,e.a(2,s.data)}},e)})),function(){return e.apply(this,arguments)})}),D=T.data,z=T.isLoading,M=i({queryKey:["admin-report-stats"],queryFn:(t=c(a().m(function e(){var t;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.get("/admin/reports/stats");case 1:return t=e.v,e.a(2,t.data.stats)}},e)})),function(){return t.apply(this,arguments)})}),R=M.data,B=x({mutationFn:(s=c(a().m(function e(t){var s,r,n;return a().w(function(e){for(;;)switch(e.n){case 0:return s=t.id,r=t.status,n=t.adminNote,e.n=1,p.put("/admin/reports/".concat(s),{status:r,adminNote:n});case 1:return e.a(2)}},e)})),function(e){return s.apply(this,arguments)}),onSuccess:function(){r.invalidateQueries({queryKey:["admin-reports"]}),r.invalidateQueries({queryKey:["admin-report-stats"]}),u("å®¡æ ¸å®Œæˆ","success"),S(null),L("")},onError:function(){u("æ“ä½œå¤±è´¥","error")}}),V=(null==D?void 0:D.reports)||[],G=(null==D?void 0:D.total)||0,W=(null==D?void 0:D.totalPages)||1;return l.jsxs("div",{className:"space-y-6",children:[m,l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:(null==R?void 0:R.pending)||0}),l.jsx("div",{className:"text-xs text-white/50",children:"å¾…å¤„ç†"})]}),l.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-4 text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-red-400",children:(null==R?void 0:R.approved)||0}),l.jsx("div",{className:"text-xs text-white/50",children:"å·²ç¡®è®¤è¿è§„"})]}),l.jsxs("div",{className:"bg-green-500/10 border border-green-500/20 rounded-xl p-4 text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-green-400",children:(null==R?void 0:R.rejected)||0}),l.jsx("div",{className:"text-xs text-white/50",children:"å·²é©³å›"})]})]}),l.jsx("div",{className:"flex gap-2",children:["","pending","approved","rejected"].map(function(e){return l.jsx("button",{onClick:function(){w(e),j(1)},className:"px-3 py-1.5 rounded-lg text-sm transition ".concat(N===e?"bg-purple-500 text-white":"bg-white/5 text-white/60 hover:bg-white/10"),children:""===e?"å…¨éƒ¨":_[e]},e)})}),z?l.jsx("div",{className:"text-center py-12 text-white/50",children:"åŠ è½½ä¸­..."}):0===V.length?l.jsx("div",{className:"text-center py-12 text-white/50",children:"æš‚æ— ä¸¾æŠ¥è®°å½•"}):l.jsx("div",{className:"space-y-3",children:V.map(function(e){return l.jsx("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-xl p-4",children:l.jsxs("div",{className:"flex gap-4",children:[l.jsx("div",{className:"w-20 h-20 rounded-lg overflow-hidden bg-white/5 flex-shrink-0 cursor-pointer",onClick:function(){return O(e.imageUrlSigned)},children:l.jsx("img",{src:g(e.imageUrlSigned)||e.imageUrlSigned,alt:"",className:"w-full h-full object-cover",onError:function(e){e.target.src=""}})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"px-2 py-0.5 rounded text-xs ".concat(E[e.status]),children:_[e.status]}),l.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-white/10 text-white/60",children:Q[e.reason]||e.reason})]}),l.jsxs("div",{className:"text-sm text-white/70 space-y-0.5",children:[l.jsxs("p",{children:["ä¸¾æŠ¥äºº: ",e.reporterName||e.reporterId]}),l.jsxs("p",{children:["è¢«ä¸¾æŠ¥äºº: ",e.reportedUserName||"æœªçŸ¥"]}),l.jsx("p",{className:"text-white/40 text-xs",children:new Date(e.createdAt).toLocaleString("zh-CN")})]}),e.adminNote&&l.jsxs("p",{className:"text-xs text-white/40 mt-1",children:["å¤‡æ³¨: ",e.adminNote]})]}),"pending"===e.status&&l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx("button",{onClick:function(){S(e),q("approved")},className:"px-3 py-1.5 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg text-xs transition",children:"ç¡®è®¤è¿è§„"}),l.jsx("button",{onClick:function(){S(e),q("rejected")},className:"px-3 py-1.5 bg-green-500/20 hover:bg-green-500/30 text-green-400 rounded-lg text-xs transition",children:"é©³å›"})]})]})},e.id)})}),W>1&&l.jsxs("div",{className:"flex justify-center gap-2",children:[l.jsx("button",{onClick:function(){return j(function(e){return Math.max(1,e-1)})},disabled:y<=1,className:"px-3 py-1.5 bg-white/5 rounded-lg text-sm disabled:opacity-30",children:"ä¸Šä¸€é¡µ"}),l.jsxs("span",{className:"px-3 py-1.5 text-sm text-white/60",children:[y," / ",W," (å…±",G,"æ¡)"]}),l.jsx("button",{onClick:function(){return j(function(e){return Math.min(W,e+1)})},disabled:y>=W,className:"px-3 py-1.5 bg-white/5 rounded-lg text-sm disabled:opacity-30",children:"ä¸‹ä¸€é¡µ"})]}),C&&l.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:function(){return S(null)},children:l.jsxs("div",{className:"bg-[#1a1a24] rounded-2xl p-6 max-w-md w-full",onClick:function(e){return e.stopPropagation()},children:[l.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"approved"===I?"ç¡®è®¤è¿è§„ - å°†åˆ é™¤å›¾ç‰‡å¹¶é€šçŸ¥åŒæ–¹":"é©³å›ä¸¾æŠ¥ - å°†é€šçŸ¥ä¸¾æŠ¥äºº"}),l.jsx("div",{className:"mb-4",children:l.jsx("img",{src:g(C.imageUrlSigned)||C.imageUrlSigned,alt:"",className:"w-full max-h-48 object-contain rounded-lg bg-white/5"})}),l.jsx("textarea",{value:F,onChange:function(e){return L(e.target.value)},placeholder:"ç®¡ç†å‘˜å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰",className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-sm text-white placeholder-white/30 mb-4 resize-none",rows:2}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:function(){return S(null)},className:"flex-1 py-2.5 bg-white/10 rounded-xl text-sm text-white",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:function(){return B.mutate({id:C.id,status:I,adminNote:F||void 0})},disabled:B.isPending,className:"flex-1 py-2.5 rounded-xl text-sm text-white font-medium ".concat("approved"===I?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"," disabled:opacity-50"),children:B.isPending?"å¤„ç†ä¸­...":"approved"===I?"ç¡®è®¤è¿è§„å¹¶åˆ é™¤":"é©³å›ä¸¾æŠ¥"})]})]})}),K&&l.jsxs("div",{className:"fixed inset-0 bg-black/95 z-50 flex items-center justify-center",onClick:function(){return O(null)},children:[l.jsx("button",{className:"absolute top-4 right-4 w-10 h-10 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center",onClick:function(){return O(null)},children:l.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),l.jsx("img",{src:K,alt:"",className:"max-w-full max-h-full object-contain",onClick:function(e){return e.stopPropagation()}})]})]})}function V(){var e,t,s,r=o(),n=h({position:"center"}),u=n.showNotification,m=n.NotificationComponent,b=d(f.useState(1),2),y=b[0],j=b[1],v=d(f.useState("pending"),2),N=v[0],w=v[1],C=d(f.useState(!1),2),S=C[0],P=C[1],I=d(f.useState(null),2),q=I[0],A=I[1],F=d(f.useState(null),2),L=F[0],U=F[1],K=d(f.useState(null),2),O=K[0],T=K[1],D=d(f.useState(""),2),z=D[0],M=D[1],R=i({queryKey:["admin-highlights",y,N],queryFn:(t=c(a().m(function e(){var t,s;return a().w(function(e){for(;;)switch(e.n){case 0:return t=new URLSearchParams({page:y.toString(),limit:"20"}),N&&t.append("status",N),e.n=1,p.get("/admin/highlights?".concat(t));case 1:return s=e.v,e.a(2,s.data)}},e)})),function(){return t.apply(this,arguments)})}),Q=R.data,_=R.isLoading,E=x({mutationFn:(s=c(a().m(function e(t){var s,r,n;return a().w(function(e){for(;;)switch(e.n){case 0:return s=t.id,r=t.status,n=t.rejectReason,e.n=1,p.put("/admin/highlights/".concat(s,"/review"),{status:r,rejectReason:n});case 1:return e.a(2)}},e)})),function(e){return s.apply(this,arguments)}),onSuccess:function(){r.invalidateQueries({queryKey:["admin-highlights"]}),P(!1),T(null),M(""),u("å®¡æ ¸å®Œæˆ","success")},onError:function(){return u("æ“ä½œå¤±è´¥","error")}}),B=function(e,t){T(e),M(""),"approved"===t?E.mutate({id:e.id,status:"approved"}):P(!0)},V=function(e){if(!e)return"-";try{return new Date(e).toLocaleString("zh-CN")}catch(t){return e}},G=(null==Q?void 0:Q.highlights)||[],W=(null==Q?void 0:Q.totalPages)||1;return l.jsxs("div",{children:[m,l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"ç²¾å½©æ—¶åˆ»å®¡æ ¸"}),l.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"å®¡æ ¸ç”¨æˆ·å‘å¸ƒçš„ç²¾å½©æ—¶åˆ»å†…å®¹"})]}),l.jsx("div",{className:"w-40",children:l.jsx(k,{value:N,onChange:function(e){w(e),j(1)},options:[{value:"pending",label:"å¾…å®¡æ ¸"},{value:"approved",label:"å·²é€šè¿‡"},{value:"rejected",label:"å·²æ‹’ç»"},{value:"",label:"å…¨éƒ¨"}]})})]}),_?l.jsx("div",{className:"flex justify-center py-20",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-purple-500"})}):0===G.length?l.jsx("div",{className:"text-center py-20 text-gray-500",children:"æš‚æ— æ•°æ®"}):l.jsx("div",{className:"space-y-4",children:G.map(function(e){var t,s={pending:{text:"å¾…å®¡æ ¸",cls:"bg-yellow-500/20 text-yellow-400"},approved:{text:"å·²é€šè¿‡",cls:"bg-green-500/20 text-green-400"},rejected:{text:"å·²æ‹’ç»",cls:"bg-red-500/20 text-red-400"}}[t=e.status]||{text:t,cls:"bg-gray-500/20 text-gray-400"};return l.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:l.jsxs("div",{className:"flex flex-col lg:flex-row",children:[l.jsx("div",{className:"lg:w-80 flex-shrink-0 p-3",children:l.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:e.photos.slice(0,6).map(function(e,t){return l.jsx("div",{className:"aspect-square rounded-lg overflow-hidden cursor-pointer hover:opacity-80 transition-opacity",onClick:function(){return U(e)},children:l.jsx("img",{src:g(e),alt:"",className:"w-full h-full object-cover"})},t)})})}),l.jsxs("div",{className:"flex-1 p-4 flex flex-col justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-start justify-between gap-3",children:[l.jsx("h3",{className:"text-white font-semibold text-lg",children:e.title}),l.jsx("span",{className:"px-2.5 py-0.5 rounded-full text-xs font-medium whitespace-nowrap ".concat(s.cls),children:s.text})]}),e.description&&l.jsx("p",{className:"text-gray-400 text-sm mt-2 line-clamp-2",children:e.description}),e.tags.length>0&&l.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2",children:e.tags.map(function(e){return l.jsxs("span",{className:"px-2 py-0.5 bg-purple-500/15 text-purple-400 rounded text-xs",children:["#",e]},e)})}),"rejected"===e.status&&e.rejectReason&&l.jsx("div",{className:"mt-2 px-3 py-2 bg-red-500/10 border border-red-500/20 rounded-lg",children:l.jsxs("p",{className:"text-red-400 text-xs",children:["æ‹’ç»åŸå› ï¼š",e.rejectReason]})})]}),l.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-700",children:[l.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.author&&l.jsxs("span",{className:"flex items-center gap-1.5",children:[e.author.avatar?l.jsx("img",{src:g(e.author.avatar),alt:"",className:"w-5 h-5 rounded-full object-cover"}):l.jsx("span",{className:"w-5 h-5 rounded-full bg-purple-600 flex items-center justify-center text-[10px] text-white",children:e.author.cnName[0]}),e.author.cnName]}),(e.city||e.province)&&l.jsxs("span",{children:["ğŸ“ ",[e.city,e.province].filter(Boolean).join(" Â· ")]}),l.jsx("span",{children:V(e.createdAt)}),l.jsxs("span",{children:["ğŸ‘ ",e.viewCount," â¤ï¸ ",e.likeCount," â­ ",e.favoriteCount]})]}),"pending"===e.status&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:function(){return B(e,"approved")},disabled:E.isPending,className:"px-3 py-1.5 bg-green-600 hover:bg-green-500 text-white text-xs rounded-lg transition-colors disabled:opacity-50",children:"âœ“ é€šè¿‡"}),l.jsx("button",{onClick:function(){return B(e,"rejected")},disabled:E.isPending,className:"px-3 py-1.5 bg-red-600 hover:bg-red-500 text-white text-xs rounded-lg transition-colors disabled:opacity-50",children:"âœ— æ‹’ç»"})]}),"pending"!==e.status&&l.jsx("button",{onClick:function(){return A(e)},className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-gray-300 text-xs rounded-lg transition-colors",children:"è¯¦æƒ…"})]})]})]})},e.id)})}),W>1&&l.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[l.jsx("button",{onClick:function(){return j(function(e){return Math.max(1,e-1)})},disabled:y<=1,className:"px-3 py-1.5 bg-gray-800 text-gray-300 rounded-lg text-sm disabled:opacity-40 hover:bg-gray-700",children:"ä¸Šä¸€é¡µ"}),l.jsxs("span",{className:"px-3 py-1.5 text-gray-400 text-sm",children:[y," / ",W]}),l.jsx("button",{onClick:function(){return j(function(e){return Math.min(W,e+1)})},disabled:y>=W,className:"px-3 py-1.5 bg-gray-800 text-gray-300 rounded-lg text-sm disabled:opacity-40 hover:bg-gray-700",children:"ä¸‹ä¸€é¡µ"})]}),S&&O&&l.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:function(){return P(!1)},children:l.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 w-full max-w-md p-6",onClick:function(e){return e.stopPropagation()},children:[l.jsx("h3",{className:"text-white font-semibold text-lg mb-1",children:"æ‹’ç»ç²¾å½©æ—¶åˆ»"}),l.jsxs("p",{className:"text-gray-400 text-sm mb-4",children:["ã€Œ",O.title,"ã€"]}),l.jsx("textarea",{value:z,onChange:function(e){return M(e.target.value)},placeholder:"è¯·è¾“å…¥æ‹’ç»åŸå› ...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm resize-none h-24 focus:outline-none focus:border-purple-500"}),l.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[l.jsx("button",{onClick:function(){return P(!1)},className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg text-sm hover:bg-gray-600",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:function(){O&&z.trim()&&E.mutate({id:O.id,status:"rejected",rejectReason:z.trim()})},disabled:!z.trim()||E.isPending,className:"px-4 py-2 bg-red-600 text-white rounded-lg text-sm hover:bg-red-500 disabled:opacity-50",children:E.isPending?"å¤„ç†ä¸­...":"ç¡®è®¤æ‹’ç»"})]})]})}),L&&l.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",onClick:function(){return U(null)},children:l.jsx("div",{className:"max-w-4xl max-h-[90vh] p-4",onClick:function(e){return e.stopPropagation()},children:l.jsx("img",{src:g(L),alt:"",className:"max-w-full max-h-[80vh] object-contain"})})}),q&&l.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:function(){return A(null)},children:l.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 w-full max-w-lg p-6 max-h-[80vh] overflow-y-auto",onClick:function(e){return e.stopPropagation()},children:[l.jsx("h3",{className:"text-white font-semibold text-lg mb-3",children:q.title}),l.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:q.photos.map(function(e,t){return l.jsx("img",{src:g(e),alt:"",className:"w-full aspect-square object-cover rounded-lg cursor-pointer hover:opacity-80",onClick:function(){return U(e)}},t)})}),q.description&&l.jsx("p",{className:"text-gray-400 text-sm mb-3",children:q.description}),l.jsxs("div",{className:"space-y-1.5 text-xs text-gray-500",children:[l.jsxs("p",{children:["ä½œè€…ï¼š",(null===(e=q.author)||void 0===e?void 0:e.cnName)||"-"]}),l.jsxs("p",{children:["ä½ç½®ï¼š",[q.city,q.province,q.country].filter(Boolean).join(" Â· ")||"-"]}),l.jsxs("p",{children:["åˆ›å»ºæ—¶é—´ï¼š",V(q.createdAt)]}),q.reviewedAt&&l.jsxs("p",{children:["å®¡æ ¸æ—¶é—´ï¼š",V(q.reviewedAt)]}),q.rejectReason&&l.jsxs("p",{className:"text-red-400",children:["æ‹’ç»åŸå› ï¼š",q.rejectReason]})]}),l.jsx("div",{className:"flex justify-end mt-4",children:l.jsx("button",{onClick:function(){return A(null)},className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg text-sm hover:bg-gray-600",children:"å…³é—­"})})]})})]})}var G=["admin","reviewer","ops"];function W(){var e=y(),t=u(),s=t.user,r=t.login,n=t.isLoading,i=d(f.useState(""),2),o=i[0],x=i[1],p=d(f.useState(""),2),h=p[0],g=p[1],b=d(f.useState(""),2),j=b[0],v=b[1],N=d(f.useState(!1),2),w=N[0],k=N[1];f.useEffect(function(){s&&G.includes(s.role)&&e("/admin")},[s,e]);var C=function(){var t=c(a().m(function t(s){var n,l;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return s.preventDefault(),v(""),k(!0),t.p=1,t.n=2,r(o,h);case 2:(n=u.getState().user)&&G.includes(n.role)?e("/admin"):(v("æ‚¨æ²¡æœ‰æƒé™è®¿é—®ç®¡ç†åå°"),u.getState().logout()),t.n=4;break;case 3:t.p=3,l=t.v,v(l.message||"ç™»å½•å¤±è´¥");case 4:return t.p=4,k(!1),t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}));return function(e){return t.apply(this,arguments)}}();return n?l.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):l.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:l.jsxs("div",{className:"w-full max-w-md",children:[l.jsxs("div",{className:"bg-gray-800 rounded-2xl p-8 border border-gray-700",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"mb-4",children:l.jsx("img",{src:m,alt:"Logo",className:"w-16 h-16 mx-auto"})}),l.jsx("h1",{className:"text-2xl font-bold text-white",children:"ç®¡ç†åå°"}),l.jsx("p",{className:"text-gray-400 mt-2",children:"Kigurumi Map Admin"})]}),l.jsxs("form",{onSubmit:C,className:"space-y-6",children:[j&&l.jsx("div",{className:"bg-red-900/30 border border-red-500/50 rounded-lg p-3 text-red-400 text-sm",children:j}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"é‚®ç®±"}),l.jsx("input",{type:"email",value:o,onChange:function(e){return x(e.target.value)},className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-purple-500 transition-colors",placeholder:"admin@example.com",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"å¯†ç "}),l.jsx("input",{type:"password",value:h,onChange:function(e){return g(e.target.value)},className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-purple-500 transition-colors",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0})]}),l.jsx("button",{type:"submit",disabled:w,className:"w-full py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-semibold rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:w?"ç™»å½•ä¸­...":"ç™»å½•"})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsx("a",{href:"/",className:"text-gray-400 hover:text-purple-400 text-sm transition-colors",children:"â† è¿”å›é¦–é¡µ"})})]}),l.jsx("p",{className:"text-center text-gray-500 text-xs mt-4",children:"ä»…é™ç®¡ç†å‘˜ã€å®¡æ ¸å‘˜ã€è¿ç»´ç™»å½•"})]})})}function $(){var e,t,r,u,m,h,g,b,y,j=o(),v=d(f.useState("devices"),2),N=v[0],w=v[1],C=d(f.useState(1),2),S=C[0],P=C[1],I=d(f.useState(1),2),q=I[0],A=I[1],F=d(f.useState(""),2),L=F[0],U=F[1],K=d(f.useState(!1),2),O=K[0],T=K[1],D=d(f.useState([]),2),z=D[0],M=D[1],R=d(f.useState({title:"",content:"",targetType:"all",targetIds:[],pushType:"notification",createNotification:!0}),2),Q=R[0],_=R[1],E=i({queryKey:["admin-devices",S,L],queryFn:(g=c(a().m(function e(){var t,s;return a().w(function(e){for(;;)switch(e.n){case 0:return t=new URLSearchParams({page:String(S),limit:"20"}),L&&t.append("platform",L),e.n=1,p.get("/admin/devices?".concat(t));case 1:return s=e.v,e.a(2,s.data)}},e)})),function(){return g.apply(this,arguments)})}),B=E.data,V=E.isLoading,G=i({queryKey:["admin-push-records",q],queryFn:(b=c(a().m(function e(){var t;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.get("/admin/push/records?page=".concat(q,"&limit=20"));case 1:return t=e.v,e.a(2,t.data)}},e)})),function(){return b.apply(this,arguments)})}),W=G.data,$=G.isLoading,H=x({mutationFn:(y=c(a().m(function e(t){var s;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.post("/admin/push/send",t);case 1:return s=e.v,e.a(2,s.data)}},e)})),function(e){return y.apply(this,arguments)}),onSuccess:function(){j.invalidateQueries({queryKey:["admin-push-records"]}),T(!1),_({title:"",content:"",targetType:"all",targetIds:[],pushType:"notification",createNotification:!0}),M([])},onError:function(e){var t;alert("æ¨é€å¤±è´¥: "+((null==e||null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.error)||e.message))}}),J={pending:{label:"å¾…å‘é€",color:"bg-yellow-600"},sent:{label:"å·²å‘é€",color:"bg-green-600"},failed:{label:"å¤±è´¥",color:"bg-red-600"},partial:{label:"éƒ¨åˆ†æˆåŠŸ",color:"bg-orange-600"}},X={all:"å…¨éƒ¨è®¾å¤‡",user:"æŒ‡å®šç”¨æˆ·",device:"æŒ‡å®šè®¾å¤‡"};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"æ¨é€ç®¡ç†"}),l.jsx("p",{className:"text-gray-400 mt-1",children:"ç®¡ç†è®¾å¤‡å’Œå‘é€æ¨é€é€šçŸ¥"})]}),l.jsxs("button",{onClick:function(){return T(!0)},className:"px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white rounded-lg flex items-center gap-2",children:[l.jsx("span",{children:"ğŸ“¤"}),l.jsx("span",{children:"å‘é€æ¨é€"})]})]}),l.jsxs("div",{className:"flex gap-2 border-b border-gray-700 pb-2",children:[l.jsxs("button",{onClick:function(){return w("devices")},className:"px-4 py-2 rounded-t-lg transition ".concat("devices"===N?"bg-purple-600 text-white":"text-gray-400 hover:text-white"),children:["è®¾å¤‡åˆ—è¡¨ (",(null==B?void 0:B.total)||0,")"]}),l.jsxs("button",{onClick:function(){return w("records")},className:"px-4 py-2 rounded-t-lg transition ".concat("records"===N?"bg-purple-600 text-white":"text-gray-400 hover:text-white"),children:["æ¨é€è®°å½• (",(null==W?void 0:W.total)||0,")"]})]}),"devices"===N&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex gap-4 items-center",children:[l.jsx("div",{className:"w-40",children:l.jsx(k,{value:L,onChange:U,options:[{value:"",label:"å…¨éƒ¨å¹³å°"},{value:"ios",label:"iOS"},{value:"android",label:"Android"}]})}),z.length>0&&l.jsxs("span",{className:"text-sm text-purple-400",children:["å·²é€‰æ‹© ",z.length," ä¸ªè®¾å¤‡"]})]}),l.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-900",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left",children:l.jsx("input",{type:"checkbox",checked:((null==B||null===(e=B.devices)||void 0===e?void 0:e.length)||0)>0&&(null==B||null===(t=B.devices)||void 0===t?void 0:t.length)===z.length,onChange:function(){var e=(null==B?void 0:B.devices)||[];if(0!==e.length){var t=e.map(function(e){return e.deviceId});M(function(e){return e.length===t.length?[]:t})}},className:"w-4 h-4 rounded bg-gray-700 border-gray-600"})}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"ç”¨æˆ·"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"å¹³å°"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"è®¾å¤‡ä¿¡æ¯"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"æœ€åæ´»è·ƒ"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-700",children:V?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:"åŠ è½½ä¸­..."})}):0===((null==B||null===(r=B.devices)||void 0===r?void 0:r.length)||0)?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:"æš‚æ— è®¾å¤‡"})}):null==B||null===(u=B.devices)||void 0===u?void 0:u.map(function(e){var t,s,r;return l.jsxs("tr",{className:"hover:bg-gray-700/50",children:[l.jsx("td",{className:"px-4 py-3",children:l.jsx("input",{type:"checkbox",checked:z.includes(e.deviceId),onChange:function(){return t=e.deviceId,void M(function(e){return e.includes(t)?e.filter(function(e){return e!==t}):[].concat(n(e),[t])});var t},className:"w-4 h-4 rounded bg-gray-700 border-gray-600"})}),l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{className:"flex items-center gap-3",children:[e.avatar?l.jsx("img",{src:e.avatar,alt:"",className:"w-8 h-8 rounded-full object-cover"}):l.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-600 flex items-center justify-center text-white text-sm",children:(null===(t=e.email)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.toUpperCase())||"?"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-white text-sm",children:e.cnName||e.email||"æœªçŸ¥ç”¨æˆ·"}),l.jsxs("p",{className:"text-gray-500 text-xs",children:[(null===(s=e.accountId)||void 0===s?void 0:s.slice(0,8))||"-","..."]})]})]})}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("ios"===e.platform?"bg-blue-600":"bg-green-600"," text-white"),children:(null===(r=e.platform)||void 0===r?void 0:r.toUpperCase())||"-"})}),l.jsxs("td",{className:"px-4 py-3 text-gray-400 text-sm",children:[l.jsx("div",{children:e.deviceModel||"-"}),l.jsx("div",{className:"text-xs text-gray-500",children:e.appVersion&&"App: ".concat(e.appVersion)})]}),l.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:e.updatedAt?new Date(e.updatedAt).toLocaleString():"-"})]},e.id)})})]})}),B&&B.totalPages>1&&l.jsxs("div",{className:"flex justify-center gap-2",children:[l.jsx("button",{onClick:function(){return P(function(e){return Math.max(1,e-1)})},disabled:1===S,className:"px-4 py-2 bg-gray-700 text-white rounded disabled:opacity-50",children:"ä¸Šä¸€é¡µ"}),l.jsxs("span",{className:"px-4 py-2 text-gray-400",children:[S," / ",B.totalPages]}),l.jsx("button",{onClick:function(){return P(function(e){return Math.min(B.totalPages,e+1)})},disabled:S===B.totalPages,className:"px-4 py-2 bg-gray-700 text-white rounded disabled:opacity-50",children:"ä¸‹ä¸€é¡µ"})]})]}),"records"===N&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-900",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"æ ‡é¢˜"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"ç›®æ ‡"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"ç±»å‹"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"çŠ¶æ€"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"å‘é€æ—¶é—´"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-700",children:$?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:"åŠ è½½ä¸­..."})}):0===((null==W||null===(m=W.records)||void 0===m?void 0:m.length)||0)?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:"æš‚æ— æ¨é€è®°å½•"})}):null==W||null===(h=W.records)||void 0===h?void 0:h.map(function(e){var t,s;return l.jsxs("tr",{className:"hover:bg-gray-700/50",children:[l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{children:[l.jsx("p",{className:"text-white font-medium",children:e.title}),l.jsx("p",{className:"text-gray-400 text-sm truncate max-w-xs",children:e.content})]})}),l.jsxs("td",{className:"px-4 py-3 text-gray-400 text-sm",children:[X[e.targetType]||e.targetType,e.targetIds&&e.targetIds.length>0&&l.jsxs("span",{className:"ml-1",children:["(",e.targetIds.length,")"]})]}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("notification"===e.pushType?"bg-purple-600":"bg-blue-600"," text-white"),children:"notification"===e.pushType?"é€šçŸ¥":"æ¶ˆæ¯"})}),l.jsxs("td",{className:"px-4 py-3",children:[l.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat((null===(t=J[e.status])||void 0===t?void 0:t.color)||"bg-gray-600"," text-white"),children:(null===(s=J[e.status])||void 0===s?void 0:s.label)||e.status}),(void 0!==e.sentCount||void 0!==e.failedCount)&&l.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["æˆåŠŸ: ",e.sentCount||0," / å¤±è´¥: ",e.failedCount||0]})]}),l.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(e.createdAt).toLocaleString()})]},e.id)})})]})}),W&&W.totalPages>1&&l.jsxs("div",{className:"flex justify-center gap-2",children:[l.jsx("button",{onClick:function(){return A(function(e){return Math.max(1,e-1)})},disabled:1===q,className:"px-4 py-2 bg-gray-700 text-white rounded disabled:opacity-50",children:"ä¸Šä¸€é¡µ"}),l.jsxs("span",{className:"px-4 py-2 text-gray-400",children:[q," / ",W.totalPages]}),l.jsx("button",{onClick:function(){return A(function(e){return Math.min(W.totalPages,e+1)})},disabled:q===W.totalPages,className:"px-4 py-2 bg-gray-700 text-white rounded disabled:opacity-50",children:"ä¸‹ä¸€é¡µ"})]})]}),O&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[l.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"å‘é€æ¨é€"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"æ ‡é¢˜ *"}),l.jsx("input",{type:"text",value:Q.title,onChange:function(e){return _(s(s({},Q),{},{title:e.target.value}))},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"æ¨é€æ ‡é¢˜"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"å†…å®¹ *"}),l.jsx("textarea",{value:Q.content,onChange:function(e){return _(s(s({},Q),{},{content:e.target.value}))},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",rows:4,placeholder:"æ¨é€å†…å®¹..."})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"æ¨é€ç±»å‹"}),l.jsx(k,{value:Q.pushType,onChange:function(e){return _(s(s({},Q),{},{pushType:e}))},options:[{value:"notification",label:"é€šçŸ¥ï¼ˆæ˜¾ç¤ºæ¨ªå¹…ï¼‰"},{value:"message",label:"æ¶ˆæ¯ï¼ˆé™é»˜ï¼‰"}]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"ç›®æ ‡èŒƒå›´"}),l.jsx(k,{value:Q.targetType,onChange:function(e){return _(s(s({},Q),{},{targetType:e}))},options:[{value:"all",label:"å…¨éƒ¨è®¾å¤‡"},{value:"device",label:"é€‰ä¸­çš„è®¾å¤‡"}]})]})]}),"device"===Q.targetType&&l.jsx("div",{className:"p-3 bg-gray-700/50 rounded-lg",children:l.jsx("p",{className:"text-sm text-gray-400",children:z.length>0?"å·²é€‰æ‹© ".concat(z.length," ä¸ªè®¾å¤‡"):"è¯·åœ¨è®¾å¤‡åˆ—è¡¨ä¸­é€‰æ‹©è¦æ¨é€çš„è®¾å¤‡"})}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",id:"createNotification",checked:Q.createNotification,onChange:function(e){return _(s(s({},Q),{},{createNotification:e.target.checked}))},className:"w-4 h-4 rounded bg-gray-700 border-gray-600"}),l.jsx("label",{htmlFor:"createNotification",className:"text-sm text-gray-300",children:"åŒæ—¶åˆ›å»ºç«™å†…é€šçŸ¥ï¼ˆç”¨æˆ·å¯åœ¨æ¶ˆæ¯ä¸­å¿ƒæŸ¥çœ‹ï¼‰"})]})]}),l.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[l.jsx("button",{onClick:function(){return T(!1)},className:"px-4 py-2 bg-gray-700 text-white rounded-lg",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:function(){var e=s({},Q);"device"===Q.targetType&&(e.targetIds=z),H.mutate(e)},disabled:!Q.title||!Q.content||"device"===Q.targetType&&0===z.length,className:"px-4 py-2 bg-purple-600 text-white rounded-lg disabled:opacity-50",children:H.isPending?"å‘é€ä¸­...":"å‘é€æ¨é€"})]})]})})]})}var H="https://gitee.com/kigermap/kigermap_app/releases/latest";function J(){var e,t,r,n,u=o(),m=d(f.useState(!1),2),h=m[0],g=m[1],b=d(f.useState(null),2),y=b[0],j=b[1],v=d(f.useState(null),2),N=v[0],w=v[1],k=d(f.useState({version:"",buildNumber:1,platform:"android",releaseNotes:"",downloadUrl:H,forceUpdate:!1}),2),C=k[0],S=k[1],P=d(f.useState(""),2),I=P[0],q=P[1],A=i({queryKey:["admin-versions"],queryFn:(e=c(a().m(function e(){var t;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.get("/admin/versions");case 1:return t=e.v,e.a(2,t.data)}},e)})),function(){return e.apply(this,arguments)})}),F=A.data,L=A.isLoading,U=x({mutationFn:(t=c(a().m(function e(t){var s;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.post("/admin/versions",t);case 1:return s=e.v,e.a(2,s.data)}},e)})),function(e){return t.apply(this,arguments)}),onSuccess:function(){u.invalidateQueries({queryKey:["admin-versions"]}),g(!1),S({version:"",buildNumber:1,platform:"android",releaseNotes:"",downloadUrl:H,forceUpdate:!1}),q("")},onError:function(e){var t;q((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.error)||"åˆ›å»ºå¤±è´¥")}}),K=x({mutationFn:(r=c(a().m(function e(t){var s;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.put("/admin/versions/".concat(t,"/toggle"));case 1:return s=e.v,e.a(2,s.data)}},e)})),function(e){return r.apply(this,arguments)}),onSuccess:function(){u.invalidateQueries({queryKey:["admin-versions"]})}}),O=x({mutationFn:(n=c(a().m(function e(t){var s;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p.delete("/admin/versions/".concat(t));case 1:return s=e.v,e.a(2,s.data)}},e)})),function(e){return n.apply(this,arguments)}),onSuccess:function(){u.invalidateQueries({queryKey:["admin-versions"]}),w(null)}}),T=(null==F?void 0:F.versions)||[],D=T.filter(function(e){return"android"===e.platform}),z=T.filter(function(e){return"ios"===e.platform}),M=D.find(function(e){return e.isActive}),R=z.find(function(e){return e.isActive});return L?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"ç‰ˆæœ¬ç®¡ç†"}),l.jsx("p",{className:"text-gray-400 mt-1",children:"ç®¡ç† App ç‰ˆæœ¬å‘å¸ƒä¸æ›´æ–°æ¨é€"})]}),l.jsx("button",{onClick:function(){return g(!h)},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2",children:h?"âœ• å–æ¶ˆ":"+ å‘å¸ƒæ–°ç‰ˆæœ¬"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-gray-800 rounded-xl p-5 border border-gray-700",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[l.jsx("span",{className:"text-2xl",children:"ğŸ¤–"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-white font-semibold",children:"Android å½“å‰ç‰ˆæœ¬"}),l.jsx("p",{className:"text-gray-400 text-sm",children:"å®¢æˆ·ç«¯æ£€æµ‹åˆ°ä½äºæ­¤ç‰ˆæœ¬å°†æç¤ºæ›´æ–°"})]})]}),M?l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{className:"text-2xl font-bold text-green-400 font-mono",children:["v",M.version]}),l.jsxs("span",{className:"text-gray-500 text-sm",children:["Build ",M.buildNumber]}),M.forceUpdate&&l.jsx("span",{className:"text-xs bg-red-900/50 text-red-300 px-2 py-0.5 rounded",children:"å¼ºåˆ¶æ›´æ–°"})]}),l.jsxs("a",{href:M.downloadUrl,target:"_blank",rel:"noopener noreferrer",className:"text-purple-400 text-sm hover:text-purple-300 truncate block",children:["ğŸ“ ",M.downloadUrl]})]}):l.jsx("p",{className:"text-gray-500",children:"æš‚æœªå‘å¸ƒ"})]}),l.jsxs("div",{className:"bg-gray-800 rounded-xl p-5 border border-gray-700",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[l.jsx("span",{className:"text-2xl",children:"ğŸ"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-white font-semibold",children:"iOS å½“å‰ç‰ˆæœ¬"}),l.jsx("p",{className:"text-gray-400 text-sm",children:"å®¢æˆ·ç«¯æ£€æµ‹åˆ°ä½äºæ­¤ç‰ˆæœ¬å°†æç¤ºæ›´æ–°"})]})]}),R?l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{className:"text-2xl font-bold text-blue-400 font-mono",children:["v",R.version]}),l.jsxs("span",{className:"text-gray-500 text-sm",children:["Build ",R.buildNumber]}),R.forceUpdate&&l.jsx("span",{className:"text-xs bg-red-900/50 text-red-300 px-2 py-0.5 rounded",children:"å¼ºåˆ¶æ›´æ–°"})]}),l.jsxs("a",{href:R.downloadUrl,target:"_blank",rel:"noopener noreferrer",className:"text-purple-400 text-sm hover:text-purple-300 truncate block",children:["ğŸ“ ",R.downloadUrl]})]}):l.jsx("p",{className:"text-gray-500",children:"æš‚æœªå‘å¸ƒ"})]})]}),l.jsx("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700/50",children:l.jsxs("p",{className:"text-gray-400 text-sm",children:["ğŸ“‹ ",l.jsx("span",{className:"text-gray-300",children:"æ›´æ–°æµç¨‹ï¼š"}),"å‘å¸ƒæ–°ç‰ˆæœ¬ â†’ App å¯åŠ¨æ—¶è°ƒç”¨ ",l.jsx("code",{className:"text-purple-400 bg-gray-700 px-1 rounded",children:"/app/version/check"})," æ£€æŸ¥æ›´æ–° â†’ å¼¹çª—æç¤ºç”¨æˆ· â†’ Android åº”ç”¨å†…ä¸‹è½½å®‰è£… / iOS è·³è½¬ App Store"]})}),h&&l.jsxs("form",{onSubmit:function(e){e.preventDefault(),C.version&&C.releaseNotes&&C.downloadUrl&&!(C.buildNumber<=0)?U.mutate(C):q("è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ")},className:"bg-gray-800 rounded-xl p-6 border border-gray-700 space-y-4",children:[l.jsx("h2",{className:"text-lg font-semibold text-white",children:"å‘å¸ƒæ–°ç‰ˆæœ¬"}),l.jsx("p",{className:"text-gray-400 text-sm",children:'å‘å¸ƒåï¼ŒåŒå¹³å°çš„æ—§ç‰ˆæœ¬å°†è‡ªåŠ¨è®¾ä¸º"å†å²ç‰ˆæœ¬"ï¼Œæ–°ç‰ˆæœ¬æˆä¸ºå½“å‰æ´»è·ƒç‰ˆæœ¬ã€‚'}),I&&l.jsx("div",{className:"text-red-400 text-sm bg-red-900/30 border border-red-500/50 rounded p-3",children:I}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"å¹³å° *"}),l.jsxs("select",{value:C.platform,onChange:function(e){var t=e.target.value;S(s(s({},C),{},{platform:t,downloadUrl:"android"===t?H:""}))},className:"w-full bg-gray-700 text-white rounded-lg px-3 py-2 border border-gray-600 focus:border-purple-500 focus:outline-none",children:[l.jsx("option",{value:"android",children:"ğŸ¤– Android"}),l.jsx("option",{value:"ios",children:"ğŸ iOS"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"ç‰ˆæœ¬å· *"}),l.jsx("input",{type:"text",value:C.version,onChange:function(e){return S(s(s({},C),{},{version:e.target.value}))},placeholder:"å¦‚ 1.2.0",className:"w-full bg-gray-700 text-white rounded-lg px-3 py-2 border border-gray-600 focus:border-purple-500 focus:outline-none"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:["æ„å»ºå· * ",l.jsx("span",{className:"text-gray-500",children:"(pubspec.yaml ä¸­ + å·åçš„æ•°å­—)"})]}),l.jsx("input",{type:"number",value:C.buildNumber,onChange:function(e){return S(s(s({},C),{},{buildNumber:parseInt(e.target.value)||0}))},min:1,className:"w-full bg-gray-700 text-white rounded-lg px-3 py-2 border border-gray-600 focus:border-purple-500 focus:outline-none"})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:["ä¸‹è½½åœ°å€ * ",l.jsxs("span",{className:"text-gray-500",children:["(","android"===C.platform?"APK ç›´é“¾ï¼Œæ”¯æŒ OSS / CDN":"App Store æˆ– TestFlight é“¾æ¥",")"]})]}),l.jsx("input",{type:"text",value:C.downloadUrl,onChange:function(e){return S(s(s({},C),{},{downloadUrl:e.target.value}))},placeholder:"android"===C.platform?"https://upload.kigermap.com/apk/kigermap-v1.2.0.apk":"https://apps.apple.com/app/...",className:"w-full bg-gray-700 text-white rounded-lg px-3 py-2 border border-gray-600 focus:border-purple-500 focus:outline-none"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:["æ›´æ–°å†…å®¹ * ",l.jsx("span",{className:"text-gray-500",children:"(å°†å±•ç¤ºåœ¨ App æ›´æ–°å¼¹çª—ä¸­)"})]}),l.jsx("textarea",{value:C.releaseNotes,onChange:function(e){return S(s(s({},C),{},{releaseNotes:e.target.value}))},rows:4,placeholder:"1. ä¿®å¤äº†åœ°å›¾æ‹–åŠ¨é—ªé€€é—®é¢˜\n2. æ–°å¢æ”¶è—åŠŸèƒ½\n3. ä¼˜åŒ–æ€§èƒ½",className:"w-full bg-gray-700 text-white rounded-lg px-3 py-2 border border-gray-600 focus:border-purple-500 focus:outline-none resize-none"})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:C.forceUpdate,onChange:function(e){return S(s(s({},C),{},{forceUpdate:e.target.checked}))},className:"w-4 h-4 rounded border-gray-600 text-purple-600 focus:ring-purple-500 bg-gray-700"}),l.jsx("span",{className:"text-sm text-gray-300",children:"å¼ºåˆ¶æ›´æ–°"})]}),l.jsx("span",{className:"text-xs text-gray-500",children:"ï¼ˆå¼€å¯åç”¨æˆ·æ— æ³•è·³è¿‡æ›´æ–°å¼¹çª—ï¼Œå¿…é¡»æ›´æ–°æ‰èƒ½ä½¿ç”¨ï¼‰"})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{type:"button",onClick:function(){return g(!1)},className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"å–æ¶ˆ"}),l.jsx("button",{type:"submit",disabled:U.isPending,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:U.isPending?"å‘å¸ƒä¸­...":"ç¡®è®¤å‘å¸ƒ"})]})]}),l.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:[l.jsxs("div",{className:"px-4 py-3 border-b border-gray-700 flex items-center justify-between",children:[l.jsx("h2",{className:"text-white font-semibold",children:"ç‰ˆæœ¬å†å²"}),l.jsxs("span",{className:"text-gray-500 text-sm",children:["å…± ",T.length," ä¸ªç‰ˆæœ¬"]})]}),0===T.length?l.jsxs("div",{className:"text-center text-gray-500 py-16",children:[l.jsx("p",{className:"text-4xl mb-3",children:"ğŸ“±"}),l.jsx("p",{children:"æš‚æ— ç‰ˆæœ¬è®°å½•"}),l.jsx("p",{className:"text-sm mt-1",children:'ç‚¹å‡»"å‘å¸ƒæ–°ç‰ˆæœ¬"å¼€å§‹'})]}):l.jsx("div",{className:"divide-y divide-gray-700/50",children:T.map(function(e){return l.jsxs("div",{className:"px-4 py-4 hover:bg-gray-700/20 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium ".concat("ios"===e.platform?"bg-blue-900/50 text-blue-300":"bg-green-900/50 text-green-300"),children:"ios"===e.platform?"ğŸ iOS":"ğŸ¤– Android"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-white font-mono font-semibold",children:["v",e.version]}),l.jsxs("span",{className:"text-gray-500 text-sm",children:["Build ",e.buildNumber]}),e.forceUpdate&&l.jsx("span",{className:"text-xs bg-red-900/50 text-red-300 px-1.5 py-0.5 rounded",children:"å¼ºåˆ¶"}),e.isActive&&l.jsx("span",{className:"text-xs bg-green-900/50 text-green-300 px-1.5 py-0.5 rounded",children:"å½“å‰ç‰ˆæœ¬"}),!e.isActive&&l.jsx("span",{className:"text-xs bg-gray-700 text-gray-400 px-1.5 py-0.5 rounded",children:"å†å²"})]}),l.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[l.jsx("span",{className:"text-gray-500 text-xs",children:e.createdByEmail||"ç³»ç»Ÿ"}),l.jsx("span",{className:"text-gray-600 text-xs",children:"Â·"}),l.jsx("span",{className:"text-gray-500 text-xs",children:new Date(e.createdAt).toLocaleString("zh-CN")})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:function(){return j(y===e.id?null:e.id)},className:"px-3 py-1.5 text-xs text-gray-400 hover:text-white bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",title:"æŸ¥çœ‹è¯¦æƒ…",children:y===e.id?"æ”¶èµ·":"è¯¦æƒ…"}),l.jsx("button",{onClick:function(){return K.mutate(e.id)},disabled:K.isPending,className:"px-3 py-1.5 text-xs rounded-lg transition-colors ".concat(e.isActive?"text-yellow-400 bg-yellow-900/30 hover:bg-yellow-900/50":"text-green-400 bg-green-900/30 hover:bg-green-900/50"),title:e.isActive?"åœç”¨æ­¤ç‰ˆæœ¬":"å¯ç”¨æ­¤ç‰ˆæœ¬",children:e.isActive?"åœç”¨":"å¯ç”¨"}),N===e.id?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:function(){return O.mutate(e.id)},disabled:O.isPending,className:"px-3 py-1.5 text-xs text-red-400 bg-red-900/50 hover:bg-red-900/70 rounded-lg transition-colors",children:"ç¡®è®¤åˆ é™¤"}),l.jsx("button",{onClick:function(){return w(null)},className:"px-2 py-1.5 text-xs text-gray-400 hover:text-white transition-colors",children:"å–æ¶ˆ"})]}):l.jsx("button",{onClick:function(){return w(e.id)},className:"px-3 py-1.5 text-xs text-red-400 bg-red-900/20 hover:bg-red-900/40 rounded-lg transition-colors",title:"åˆ é™¤ç‰ˆæœ¬",children:"åˆ é™¤"})]})]}),y===e.id&&l.jsxs("div",{className:"mt-3 ml-[72px] space-y-3",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-400 text-xs mb-1",children:"æ›´æ–°å†…å®¹"}),l.jsx("div",{className:"bg-gray-900/50 rounded-lg p-3 text-sm text-gray-300 whitespace-pre-wrap",children:e.releaseNotes})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-400 text-xs mb-1",children:"ä¸‹è½½åœ°å€"}),l.jsx("a",{href:e.downloadUrl,target:"_blank",rel:"noopener noreferrer",className:"text-purple-400 text-sm hover:text-purple-300 break-all",children:e.downloadUrl})]})]})]},e.id)})})]})]})}var X=["admin","reviewer","ops"];function Y(e){var t=e.children,s=u(),r=s.user;return s.isInitialized?r&&X.includes(r.role)?l.jsx(l.Fragment,{children:t}):l.jsx(w,{to:"/admin/login",replace:!0}):l.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-500"})})}}}})}();
