!function(){function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var r,n,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function l(e,a,i,o){var l=a&&a.prototype instanceof s?a:s,u=Object.create(l.prototype);return t(u,"_invoke",function(e,t,a){var i,o,l,s=0,u=a||[],d=!1,f={p:0,n:0,v:r,a:m,f:m.bind(r,4),d:function(e,t){return i=e,o=0,l=r,f.n=t,c}};function m(e,t){for(o=e,l=t,n=0;!d&&s&&!a&&n<u.length;n++){var a,i=u[n],m=f.p,h=i[2];e>3?(a=h===t)&&(l=i[(o=i[4])?5:(o=3,3)],i[4]=i[5]=r):i[0]<=m&&((a=e<2&&m<i[1])?(o=0,f.v=t,f.n=i[1]):m<h&&(a=e<3||i[0]>t||t>h)&&(i[4]=e,i[5]=t,f.n=h,o=0))}if(a||e>1)return c;throw d=!0,t}return function(a,u,h){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,h),o=u,l=h;(n=o<2?r:l)||!d;){i||(o?o<3?(o>1&&(f.n=-1),m(o,l)):f.n=l:f.v=l);try{if(s=2,i){if(o||(a="next"),n=i[a]){if(!(n=n.call(i,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,o<2&&(o=0)}else 1===o&&(n=i.return)&&n.call(i),o<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),o=1);i=r}else if((n=(d=f.n<0)?l:e.call(t,f))!==c)break}catch(n){i=r,o=1,l=n}finally{s=1}}return{value:n,done:d}}}(e,i,o),!0),u}var c={};function s(){}function u(){}function d(){}n=Object.getPrototypeOf;var f=[][i]?n(n([][i]())):(t(n={},i,function(){return this}),n),m=d.prototype=s.prototype=Object.create(f);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=d,t(m,"constructor",d),t(d,"constructor",u),u.displayName="GeneratorFunction",t(d,o,"GeneratorFunction"),t(m),t(m,o,"Generator"),t(m,i,function(){return this}),t(m,"toString",function(){return"[object Generator]"}),(e=function(){return{w:l,m:h}})()}function t(e,r,n,a){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,r,n,a){function o(r,n){t(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},t(e,r,n,a)}function r(e,t,r,n,a,i,o){try{var l=e[i](o),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,a)}function n(e){return function(){var t=this,n=arguments;return new Promise(function(a,i){var o=e.apply(t,n);function l(e){r(o,a,i,l,c,"next",e)}function c(e){r(o,a,i,l,c,"throw",e)}l(void 0)})}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],c=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}System.register(["./query-legacy-CLxXWLnl.js","./sentry-legacy-CTr2CudU.js","./index-legacy-DVoFAd51.js","./AliyunCaptcha-legacy-DY0FTlyp.js","./router-legacy-9xrJEksD.js","./store-legacy-Bt3CCSnU.js"],function(t,r){"use strict";var i,o,l,c,s,u,d,f,m,h,p;return{setters:[function(e){i=e.j},function(e){o=e.a},function(e){l=e.u,c=e.a,s=e.b,u=e.L,d=e.l},function(e){f=e.A},function(e){m=e.a,h=e.c,p=e.L},null],execute:function(){t("default",function(){var t=a(o.useState("email"),2),r=t[0],x=t[1],g=a(o.useState(""),2),b=g[0],v=g[1],w=a(o.useState(""),2),y=w[0],j=w[1],N=a(o.useState(""),2),S=N[0],k=N[1],I=a(o.useState(""),2),C=I[0],O=I[1],_=a(o.useState(0),2),T=_[0],L=_[1],R=a(o.useState(0),2),A=R[0],E=R[1],P=a(o.useState(""),2),q=P[0],D=P[1],M=a(o.useState(""),2),F=M[0],G=M[1],z=a(o.useState(0),2),V=z[0],W=z[1],B=a(o.useState(""),2),K=B[0],$=B[1],J=a(o.useState(!1),2),H=J[0],U=J[1],Q=a(o.useState(""),2),X=Q[0],Y=Q[1],Z=o.useRef(null),ee=o.useRef(null),te=o.useRef(null),re=l(),ne=re.register,ae=re.phoneLogin,ie=re.sendCode,oe=re.sendPhoneCode,le=re.isLoading,ce=re.error,se=re.clearError,ue=m(),de=a(h(),1)[0],fe=c().t,me="k"===de.get("_m");o.useEffect(function(){var e=de.get("invite");if(e&&/^[A-Fa-f0-9]{8}$/i.test(e))$(e),localStorage.setItem("inviteCode",e),s.post("/invite/visit/".concat(e)).catch(function(){});else{var t=localStorage.getItem("inviteCode");t&&/^[A-F0-9]{8}$/i.test(t)&&$(t)}},[de]),o.useEffect(function(){return T>0&&!Z.current&&(Z.current=setInterval(function(){L(function(e){return e<=1?(Z.current&&(clearInterval(Z.current),Z.current=null),0):e-1})},1e3)),function(){Z.current&&0===T&&(clearInterval(Z.current),Z.current=null)}},[T>0]),o.useEffect(function(){return A>0&&!ee.current&&(ee.current=setInterval(function(){E(function(e){return e<=1?(ee.current&&(clearInterval(ee.current),ee.current=null),0):e-1})},1e3)),function(){ee.current&&0===A&&(clearInterval(ee.current),ee.current=null)}},[A>0]),o.useEffect(function(){return function(){Z.current&&clearInterval(Z.current),ee.current&&clearInterval(ee.current),te.current&&clearInterval(te.current)}},[]);var he=function(){var t=n(e().m(function t(r){var n,a,i;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(b&&!(T>0)){e.n=1;break}return e.a(2,{captchaVerifyResult:!0,bizResult:!1});case 1:return se(),e.p=2,e.n=3,ie(b,r,"register");case 3:return Z.current&&(clearInterval(Z.current),Z.current=null),ee.current&&(clearInterval(ee.current),ee.current=null),L(60),E(600),e.a(2,{captchaVerifyResult:!0,bizResult:!0});case 4:throw e.p=4,i=e.v,(a=null==i||null===(n=i.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.retryAfter)&&a>0&&(Z.current&&(clearInterval(Z.current),Z.current=null),L(Math.min(a,600))),i;case 5:return e.a(2)}},t,null,[[2,4]])}));return function(e){return t.apply(this,arguments)}}(),pe=function(){var t=n(e().m(function t(r){var n,a,i;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!(!q||V>0||le)){e.n=1;break}return e.a(2,{captchaVerifyResult:!0,bizResult:!1});case 1:if(/^1[3-9]\d{9}$/.test(q)){e.n=2;break}return l.setState({error:"请输入正确的手机号"}),e.a(2,{captchaVerifyResult:!0,bizResult:!1});case 2:return se(),e.p=3,e.n=4,oe(q,r,"register");case 4:return W(60),te.current&&clearInterval(te.current),te.current=setInterval(function(){W(function(e){return e<=1?(te.current&&(clearInterval(te.current),te.current=null),0):e-1})},1e3),e.a(2,{captchaVerifyResult:!0,bizResult:!0});case 5:throw e.p=5,i=e.v,(a=null==i||null===(n=i.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.retryAfter)&&a>0&&W(Math.min(a,60)),i;case 6:return e.a(2)}},t,null,[[3,5]])}));return function(e){return t.apply(this,arguments)}}(),xe=function(){var t=n(e().m(function t(r){var n,a,i;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r.preventDefault(),se(),Y(""),y===S){e.n=1;break}return Y("两次输入的密码不一致"),e.a(2);case 1:return e.p=1,n=(new Date).toISOString(),e.n=2,ne(b,y,C,K||void 0,n);case 2:if(localStorage.removeItem("inviteCode"),!me||!window.KigerBridge){e.n=3;break}return a=localStorage.getItem("token"),i=localStorage.getItem("user"),window.KigerBridge.postMessage(JSON.stringify({_t:"cb",_k:a,_u:i})),e.a(2);case 3:ue("/",{replace:!0}),e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},t,null,[[1,4]])}));return function(e){return t.apply(this,arguments)}}(),ge=function(){var t=n(e().m(function t(r){var n,a,i;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return r.preventDefault(),se(),e.p=1,n=(new Date).toISOString(),e.n=2,ae(q,F,"register",n,K||void 0);case 2:if(localStorage.removeItem("inviteCode"),!me||!window.KigerBridge){e.n=3;break}return a=localStorage.getItem("token"),i=localStorage.getItem("user"),window.KigerBridge.postMessage(JSON.stringify({_t:"cb",_k:a,_u:i})),e.a(2);case 3:ue("/",{replace:!0}),e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},t,null,[[1,4]])}));return function(e){return t.apply(this,arguments)}}(),be=i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("input",{type:"checkbox",id:"agree-terms",checked:H,onChange:function(e){return U(e.target.checked)},className:"mt-1 w-4 h-4 rounded border-white/30 bg-white/10 text-primary focus:ring-primary/50"}),i.jsxs("label",{htmlFor:"agree-terms",className:"text-sm text-white/60 leading-relaxed",children:["我已阅读并同意"," ",i.jsx(p,{to:"/terms",target:"_blank",className:"text-primary hover:underline",children:"《服务条款》"}),"、",i.jsx(p,{to:"/privacy",target:"_blank",className:"text-primary hover:underline",children:"《隐私政策》"})," ","和"," ",i.jsx(p,{to:"/agreement",target:"_blank",className:"text-primary hover:underline",children:"《用户协议》"})]})]});return i.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 relative",children:[i.jsx("div",{className:"bg-animated"}),i.jsxs("div",{className:"glass-dark rounded-3xl p-8 w-full max-w-md",children:[i.jsx("div",{className:"flex justify-end mb-4",children:i.jsx(u,{})}),i.jsxs("div",{className:"text-center mb-8",children:[i.jsxs("div",{className:"inline-flex items-center gap-3 cursor-pointer select-none",onClick:function(e){e.currentTarget.classList.remove("animate-seesaw"),e.currentTarget.offsetWidth,e.currentTarget.classList.add("animate-seesaw"),setTimeout(function(){return e.currentTarget.classList.remove("animate-seesaw")},600)},children:[i.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-primary to-secondary flex items-center justify-center",children:i.jsx("img",{src:d,alt:"Logo",className:"w-10 h-10"})}),i.jsx("span",{className:"text-2xl font-bold text-gradient",children:fe("app.name")})]}),i.jsx("p",{className:"text-white/50 mt-2",children:fe("login.register.title")})]}),i.jsxs("div",{className:"flex gap-1 p-1 bg-white/[0.03] border border-white/[0.06] rounded-xl mb-6",children:[i.jsx("button",{onClick:function(){x("email"),se(),Y("")},className:"flex-1 py-2 rounded-lg text-sm font-medium transition-all ".concat("email"===r?"bg-white/10 text-white":"text-white/50 hover:text-white/70"),children:"邮箱注册"}),i.jsx("button",{onClick:function(){x("phone"),se(),Y("")},className:"flex-1 py-2 rounded-lg text-sm font-medium transition-all ".concat("phone"===r?"bg-white/10 text-white":"text-white/50 hover:text-white/70"),children:"手机号注册"})]}),"email"===r&&i.jsxs("form",{onSubmit:xe,className:"space-y-5",children:[(ce||X)&&i.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/30 rounded-xl text-red-300 text-sm",children:ce||X}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:fe("login.email")}),i.jsx("input",{type:"email",value:b,onChange:function(e){return v(e.target.value)},placeholder:fe("login.email.placeholder"),required:!0,className:"w-full max-w-full px-4 py-3.5 input-modern rounded-xl text-white placeholder-white/30 outline-none box-border",style:{minWidth:0}})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-white/80 mb-2",children:[fe("login.verificationCode"),A>0&&i.jsxs("span",{className:"ml-2 text-xs text-primary",children:[fe("login.verificationCode.expires")," ",Math.floor(A/60),":",(A%60).toString().padStart(2,"0")]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("input",{type:"text",value:C,onChange:function(e){return O(e.target.value.replace(/\D/g,"").slice(0,6))},placeholder:fe("login.verificationCode.placeholder"),required:!0,maxLength:6,className:"flex-1 min-w-0 px-4 py-3.5 input-modern rounded-xl text-white placeholder-white/30 outline-none box-border"}),i.jsx(f,{onSuccess:he,onError:function(e){return l.setState({error:e})},buttonText:le?fe("login.sending"):T>0?T>=60?"".concat(Math.floor(T/60),":").concat((T%60).toString().padStart(2,"0")):"".concat(T,"s"):fe("login.sendCode"),buttonClassName:"px-4 py-3.5 btn-gradient rounded-xl font-medium text-white transition whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",disabled:le||T>0||!b})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:fe("login.password")}),i.jsx("input",{type:"password",value:y,onChange:function(e){return j(e.target.value)},placeholder:fe("login.password.placeholder"),required:!0,minLength:6,className:"w-full max-w-full px-4 py-3.5 input-modern rounded-xl text-white placeholder-white/30 outline-none box-border",style:{minWidth:0}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:fe("login.confirmPassword")}),i.jsx("input",{type:"password",value:S,onChange:function(e){return k(e.target.value)},placeholder:fe("login.confirmPassword.placeholder"),required:!0,minLength:6,className:"w-full max-w-full px-4 py-3.5 input-modern rounded-xl text-white placeholder-white/30 outline-none box-border",style:{minWidth:0}})]}),be,i.jsx("button",{type:"submit",disabled:le||!C||!H,className:"w-full py-3.5 btn-gradient rounded-xl font-medium text-white transition touch-target disabled:opacity-50",children:fe(le?"login.submitting":"login.register.submit")})]}),"phone"===r&&i.jsxs("form",{onSubmit:ge,className:"space-y-5",children:[ce&&i.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/30 rounded-xl text-red-300 text-sm",children:ce}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"手机号"}),i.jsx("input",{type:"tel",value:q,onChange:function(e){return D(e.target.value.replace(/\D/g,"").slice(0,11))},placeholder:"请输入手机号",required:!0,maxLength:11,className:"w-full max-w-full px-4 py-3.5 input-modern rounded-xl text-white placeholder-white/30 outline-none box-border",style:{minWidth:0}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"验证码"}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("input",{type:"text",value:F,onChange:function(e){return G(e.target.value.replace(/\D/g,"").slice(0,6))},placeholder:"请输入验证码",required:!0,maxLength:6,className:"flex-1 min-w-0 px-4 py-3.5 input-modern rounded-xl text-white placeholder-white/30 outline-none box-border"}),i.jsx(f,{onSuccess:pe,onError:function(e){return l.setState({error:e})},buttonText:V>0?"".concat(V,"s"):"发送验证码",buttonClassName:"px-4 py-3.5 btn-gradient rounded-xl font-medium text-white transition whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",disabled:V>0||le||!q})]})]}),be,i.jsx("button",{type:"submit",disabled:le||!F||!H,className:"w-full py-3.5 btn-gradient rounded-xl font-medium text-white transition touch-target disabled:opacity-50",children:le?"注册中...":"注册"})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsx(p,{to:"/login",className:"text-white/60 hover:text-white transition text-sm",children:fe("login.switchToLogin")})}),i.jsx("div",{className:"mt-6 pt-6 border-t border-white/10 text-center",children:i.jsx(p,{to:"https://kighub.cn/",className:"text-white/50 hover:text-white transition text-sm",children:fe("login.backHome")})})]})]})})}}})}();
